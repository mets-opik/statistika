<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Peatükk 7 Mitme tunnuse koosanalüüs | Metsanduslik statistika R ja MS Excel keskkonnas</title>
  <meta name="description" content="Metsandusliku statistika õpik" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Peatükk 7 Mitme tunnuse koosanalüüs | Metsanduslik statistika R ja MS Excel keskkonnas" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Metsandusliku statistika õpik" />
  <meta name="github-repo" content="xyzallan/met-stat-opik" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Peatükk 7 Mitme tunnuse koosanalüüs | Metsanduslik statistika R ja MS Excel keskkonnas" />
  
  <meta name="twitter:description" content="Metsandusliku statistika õpik" />
  

<meta name="author" content="Allan Sims, Andres Kiviste, Diana Laarmann" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistilised-hinnangud.html"/>
<link rel="next" href="mittelineaarne-regressioon.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="sissejuhatus.html"><a href="sissejuhatus.html"><i class="fa fa-check"></i><b>1</b> Sissejuhatus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sissejuhatus.html"><a href="sissejuhatus.html#statistikaprogramm-r"><i class="fa fa-check"></i><b>1.1</b> Statistikaprogramm R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="sissejuhatus.html"><a href="sissejuhatus.html#r-i-paketid"><i class="fa fa-check"></i><b>1.1.1</b> R-i paketid</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sissejuhatus.html"><a href="sissejuhatus.html#ms-excel"><i class="fa fa-check"></i><b>1.2</b> MS Excel</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="andmestik.html"><a href="andmestik.html"><i class="fa fa-check"></i><b>2</b> Andmestik</a>
<ul>
<li class="chapter" data-level="2.1" data-path="andmestik.html"><a href="andmestik.html#andmestiku-struktuur-r-keskkonnas"><i class="fa fa-check"></i><b>2.1</b> Andmestiku struktuur R keskkonnas</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="andmestik.html"><a href="andmestik.html#vektor"><i class="fa fa-check"></i><b>2.1.1</b> Vektor</a></li>
<li class="chapter" data-level="2.1.2" data-path="andmestik.html"><a href="andmestik.html#maatriks"><i class="fa fa-check"></i><b>2.1.2</b> Maatriks</a></li>
<li class="chapter" data-level="2.1.3" data-path="andmestik.html"><a href="andmestik.html#andmetabel"><i class="fa fa-check"></i><b>2.1.3</b> Andmetabel</a></li>
<li class="chapter" data-level="2.1.4" data-path="andmestik.html"><a href="andmestik.html#list"><i class="fa fa-check"></i><b>2.1.4</b> List</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="andmestik.html"><a href="andmestik.html#andmestike-importimine-r-keskkonda"><i class="fa fa-check"></i><b>2.2</b> Andmestike importimine R keskkonda</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="07-mitmetunnuse.html"><a href="#andmestike-r%C3%BChmitamine"><i class="fa fa-check"></i><b>3</b> Andmestike rühmitamine</a>
<ul>
<li class="chapter" data-level="3.1" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html"><i class="fa fa-check"></i><b>3.1</b> Jaotused</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#empiiriline-jaotus"><i class="fa fa-check"></i><b>3.1.1</b> Empiiriline jaotus</a></li>
<li class="chapter" data-level="3.1.2" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#teoreetiline-jaotus"><i class="fa fa-check"></i><b>3.1.2</b> Teoreetiline jaotus</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#histogramm"><i class="fa fa-check"></i><b>3.2</b> Histogramm</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#r-keskkonnas"><i class="fa fa-check"></i><b>3.2.1</b> R keskkonnas:</a></li>
<li class="chapter" data-level="3.2.2" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#exceli-keskkonnas"><i class="fa fa-check"></i><b>3.2.2</b> Exceli keskkonnas:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="karakteristikud.html"><a href="karakteristikud.html"><i class="fa fa-check"></i><b>4</b> Karakteristikud</a>
<ul>
<li class="chapter" data-level="4.1" data-path="karakteristikud.html"><a href="karakteristikud.html#keskmised"><i class="fa fa-check"></i><b>4.1</b> Keskmised</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="karakteristikud.html"><a href="karakteristikud.html#aritmeetiline-keskmine"><i class="fa fa-check"></i><b>4.1.1</b> Aritmeetiline keskmine</a></li>
<li class="chapter" data-level="4.1.2" data-path="karakteristikud.html"><a href="karakteristikud.html#ruutkeskmine"><i class="fa fa-check"></i><b>4.1.2</b> Ruutkeskmine</a></li>
<li class="chapter" data-level="4.1.3" data-path="karakteristikud.html"><a href="karakteristikud.html#geomeetriline-keskmine"><i class="fa fa-check"></i><b>4.1.3</b> Geomeetriline keskmine</a></li>
<li class="chapter" data-level="4.1.4" data-path="karakteristikud.html"><a href="karakteristikud.html#harmooniline-keskmine"><i class="fa fa-check"></i><b>4.1.4</b> Harmooniline keskmine</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="karakteristikud.html"><a href="karakteristikud.html#kvantiilid"><i class="fa fa-check"></i><b>4.2</b> Kvantiilid</a></li>
<li class="chapter" data-level="4.3" data-path="karakteristikud.html"><a href="karakteristikud.html#mediaan"><i class="fa fa-check"></i><b>4.3</b> Mediaan</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html"><i class="fa fa-check"></i><b>5</b> Jaotusfunktsioonid</a>
<ul>
<li class="chapter" data-level="5.1" data-path="07-mitmetunnuse.html"><a href="#h%C3%BCpotees"><i class="fa fa-check"></i><b>5.1</b> Hüpotees</a></li>
<li class="chapter" data-level="5.2" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#jaotusfunktsioon"><i class="fa fa-check"></i><b>5.2</b> Jaotusfunktsioon</a></li>
<li class="chapter" data-level="5.3" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#tihedusfunktsioon"><i class="fa fa-check"></i><b>5.3</b> Tihedusfunktsioon</a></li>
<li class="chapter" data-level="5.4" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#normaaljaotus"><i class="fa fa-check"></i><b>5.4</b> Normaaljaotus</a></li>
<li class="chapter" data-level="5.5" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#t-jaotus"><i class="fa fa-check"></i><b>5.5</b> T-jaotus</a></li>
<li class="chapter" data-level="5.6" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#f-jaotus"><i class="fa fa-check"></i><b>5.6</b> F-jaotus</a></li>
<li class="chapter" data-level="5.7" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#hii-ruut-jaotus"><i class="fa fa-check"></i><b>5.7</b> Hii-ruut-jaotus</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html"><i class="fa fa-check"></i><b>6</b> Statistilised hinnangud</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#hinnangud"><i class="fa fa-check"></i><b>6.1</b> Hinnangud</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#punkthinnang"><i class="fa fa-check"></i><b>6.1.1</b> Punkthinnang</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#vahemikhinnangud"><i class="fa fa-check"></i><b>6.2</b> Vahemikhinnangud</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="07-mitmetunnuse.html"><a href="#keskv%C3%A4%C3%A4rtuse-usalduspiirid"><i class="fa fa-check"></i><b>6.2.1</b> Keskväärtuse usalduspiirid</a></li>
<li class="chapter" data-level="6.2.2" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#dispersiooni-usalduspiirid"><i class="fa fa-check"></i><b>6.2.2</b> Dispersiooni usalduspiirid</a></li>
<li class="chapter" data-level="6.2.3" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#binoomjaotuse-usalduspiirid"><i class="fa fa-check"></i><b>6.2.3</b> Binoomjaotuse usalduspiirid</a></li>
<li class="chapter" data-level="6.2.4" data-path="07-mitmetunnuse.html"><a href="#standardh%C3%A4lbe-usalduspiirid"><i class="fa fa-check"></i><b>6.2.4</b> Standardhälbe usalduspiirid</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="07-mitmetunnuse.html"><a href="#mitme-tunnuse-koosanal%C3%BC%C3%BCs"><i class="fa fa-check"></i><b>7</b> Mitme tunnuse koosanalüüs</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mitme-tunnuse-koosanalüüs.html"><a href="mitme-tunnuse-koosanalüüs.html"><i class="fa fa-check"></i><b>7.1</b> Lineaarne regressioon</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="mitme-tunnuse-koosanalüüs.html"><a href="mitme-tunnuse-koosanalüüs.html#lineaarne-regressioon-r-keskkonnas"><i class="fa fa-check"></i><b>7.1.1</b> Lineaarne regressioon R keskkonnas</a></li>
<li class="chapter" data-level="7.1.2" data-path="mitme-tunnuse-koosanalüüs.html"><a href="mitme-tunnuse-koosanalüüs.html#lineaarne-regressioon-ms-exceli-keskkonnas"><i class="fa fa-check"></i><b>7.1.2</b> Lineaarne regressioon MS Exceli keskkonnas</a></li>
<li class="chapter" data-level="7.1.3" data-path="07-mitmetunnuse.html"><a href="#regressioonanal%C3%BC%C3%BCsi-tulemuste-t%C3%B5lgendamine"><i class="fa fa-check"></i><b>7.1.3</b> Regressioonanalüüsi tulemuste tõlgendamine</a></li>
<li class="chapter" data-level="7.1.4" data-path="mitme-tunnuse-koosanalüüs.html"><a href="mitme-tunnuse-koosanalüüs.html#homoskedastilisuse-testimine"><i class="fa fa-check"></i><b>7.1.4</b> Homoskedastilisuse testimine</a></li>
<li class="chapter" data-level="7.1.5" data-path="07-mitmetunnuse.html"><a href="#j%C3%A4%C3%A4kide-normaalsuse-test"><i class="fa fa-check"></i><b>7.1.5</b> Jääkide normaalsuse test</a></li>
<li class="chapter" data-level="7.1.6" data-path="mitme-tunnuse-koosanalüüs.html"><a href="mitme-tunnuse-koosanalüüs.html#multikollineaarsus"><i class="fa fa-check"></i><b>7.1.6</b> Multikollineaarsus</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="07-mitmetunnuse.html"><a href="#dispersioonanal%C3%BC%C3%BCs"><i class="fa fa-check"></i><b>7.2</b> Dispersioonanalüüs</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mittelineaarne-regressioon.html"><a href="mittelineaarne-regressioon.html"><i class="fa fa-check"></i><b>8</b> Mittelineaarne regressioon</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mittelineaarne-regressioon.html"><a href="mittelineaarne-regressioon.html#r"><i class="fa fa-check"></i><b>8.1</b> R</a></li>
<li class="chapter" data-level="8.2" data-path="mittelineaarne-regressioon.html"><a href="mittelineaarne-regressioon.html#ms-excel-1"><i class="fa fa-check"></i><b>8.2</b> MS Excel</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="07-mitmetunnuse.html"><a href="#mitteparameetriline-anal%C3%BC%C3%BCs"><i class="fa fa-check"></i><b>9</b> Mitteparameetriline analüüs</a>
<ul>
<li class="chapter" data-level="9.1" data-path="07-mitmetunnuse.html"><a href="#%C3%BCldistatud-aditiivne-mudel"><i class="fa fa-check"></i><b>9.1</b> Üldistatud aditiivne mudel</a></li>
<li class="chapter" data-level="9.2" data-path="mitteparameetriline-analüüs.html"><a href="mitteparameetriline-analüüs.html"><i class="fa fa-check"></i><b>9.2</b> Visualiseerimine paketiga <code>ggplot2</code></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Metsanduslik statistika R ja MS Excel keskkonnas</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mitme-tunnuse-koosanalüüs" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Peatükk 7</span> Mitme tunnuse koosanalüüs<a href="#mitme-tunnuse-koosanal%C3%BC%C3%BCs" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="lineaarne-regressioon" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Lineaarne regressioon<a href="mitme-tunnuse-koosanalüüs.html#lineaarne-regressioon" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Lineaarne regressioon on üks viis, kuidas uurida, kuidas kaks või enam asja on omavahel seotud. Selle abil saame aru saada, kuidas ühe tunnuse muutumine mõjutab teist. Näiteks, kui me teame, kuidas ühe tunnuse väärtus muutub, saame ennustada, mis võib juhtuda teise tunnusega.</p>
<p>Lineaarne regressioon lähtub eeldusest, et kahe asja vaheline suhe on sirgejooneline. See tähendab, et kui üks tunnus muutub, siis teine asi muutub kindlal viisil, mida saab joonistada sirgjoonena. Selle meetodi eesmärk on leida kõige sobivam sirgjoon, mis näitab, kuidas need kaks tunnust on omavahel seotud. Lineaarse regressioonimudeli võib esitada võrrandina:</p>
<p><span class="math display">\[Y = a + bX + \epsilon \]</span></p>
<p>Kus:</p>
<ul>
<li>Y on funktsioontunnus</li>
<li>X on argumenttunnus</li>
<li>a on lõikepunkt, mis näitab, kui suur on Y väärtus, kui X väärtus on 0</li>
<li>b on regresseerimiskordaja, mis näitab, kui palju muutub Y väärtus, kui X väärtus suureneb ühe ühiku võrra</li>
<li><span class="math inline">\(\epsilon\)</span> on veaväärtus, mis tähistab juhuslikke kõrvalekaldeid mudelist</li>
</ul>
<p>Lineaarse regressiooni puhul kasutatakse mitmesuguseid meetodeid, et hinnata, kui hästi meie sirgjoon mudelina toimib. Üks selline meetod on vähim ruutude meetod. See tähendab, et me otsime sirgjoont, mis käitub nii, et meie ennustuste ja tegelikkuses mõõdetud väärtuste erinevused oleksid võimalikult väikesed. Lihtsamalt öeldes, me püüame leida sirgjoont, mis sobib kõige paremini meie andmetega, minimeerides vigu ennustustes.</p>
<p>Lineaarse regressiooni usaldusväärsed tulemused sõltuvad teatud eeldustest. Need eeldused aitavad tagada, et meie analüüs peegeldaks tegelikkust võimalikult täpselt. Siin on need eeldused lihtsustatult:</p>
<ul>
<li><p><strong>Lineaarsus.</strong> Eeldatakse, et kahe tunnuse vaheline suhe on sirgjooneline. See tähendab, et kui üks tunnus muutub, siis teise tunnus vastus on alati sellega proportsioonis, sõltumata olukorrast.</p></li>
<li><p><strong>Normaaljaotus.</strong> Hälve ehk ennustuste ja tegelike tulemuste erinevused järgivad kindlat mustrit, mis vastab normaaljaotusele.</p></li>
<li><p><strong>Homoskedastilisus.</strong> Sõltuva tunnuse väärtuste hajuvus on ühtlane kogu sõltumatu tunnuse ulatuses, mis tähendab, et erinevused ei suurene ega vähene sõltumatu tunnuse väärtuse kasvades.</p></li>
<li><p><strong>Autokorrelatsiooni puudumine.</strong> Vaatluste vead on omavahel sõltumatud, st et ühe vaatluse viga ei mõjuta teise vaatluse viga.</p></li>
<li><p><strong>Multikollineaarsuse puudumine.</strong> Analüüsitavad tunnused on sõltumatud, st ühe tunnuse väärtus ei sõltu teise tunnuse väärtusest ega ole nendega liiga tihedalt seotud.</p></li>
</ul>
<p>Need eeldused aitavad tagada, et lineaarne regressioonimudel oleks usaldusväärne ja et selle abil tehtud järeldused peegeldaksid tegelikke seoseid.</p>
<div id="lineaarne-regressioon-r-keskkonnas" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Lineaarne regressioon R keskkonnas<a href="mitme-tunnuse-koosanalüüs.html#lineaarne-regressioon-r-keskkonnas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="mitme-tunnuse-koosanalüüs.html#cb80-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb80-2"><a href="mitme-tunnuse-koosanalüüs.html#cb80-2" tabindex="-1"></a><span class="co"># Laadime peatükis kasutatavad paketid</span></span>
<span id="cb80-3"><a href="mitme-tunnuse-koosanalüüs.html#cb80-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb80-4"><a href="mitme-tunnuse-koosanalüüs.html#cb80-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb80-5"><a href="mitme-tunnuse-koosanalüüs.html#cb80-5" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb80-6"><a href="mitme-tunnuse-koosanalüüs.html#cb80-6" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb80-7"><a href="mitme-tunnuse-koosanalüüs.html#cb80-7" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span></code></pre></div>
<p>Loeme andmed failist <a href="data/naited.xlsx">naited.xlsx</a> töölehelt “prt_andmed” ja salvestame selle tabelisse:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="mitme-tunnuse-koosanalüüs.html#cb81-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb81-2"><a href="mitme-tunnuse-koosanalüüs.html#cb81-2" tabindex="-1"></a>andmed <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/naited.xlsx&quot;</span>,<span class="st">&quot;prt_andmed&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(h <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code></pre></div>
<p>Teeme lineaarse regressiooni tunnuste D ja H vahel:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="mitme-tunnuse-koosanalüüs.html#cb82-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb82-2"><a href="mitme-tunnuse-koosanalüüs.html#cb82-2" tabindex="-1"></a><span class="fu">print</span>(lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(h <span class="sc">~</span> d, <span class="at">data =</span> andmed))</span></code></pre></div>
<pre><code>
Call:
lm(formula = h ~ d, data = andmed)

Coefficients:
(Intercept)            d  
     16,295        0,332  </code></pre>
<p>Järgnevalt visualiseerime nii andmeid kui ka mudelit funktsiooni <code>ggplot()</code> abil.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="mitme-tunnuse-koosanalüüs.html#cb84-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb84-2"><a href="mitme-tunnuse-koosanalüüs.html#cb84-2" tabindex="-1"></a><span class="fu">ggplot</span>(andmed, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> h)) <span class="sc">+</span></span>
<span id="cb84-3"><a href="mitme-tunnuse-koosanalüüs.html#cb84-3" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>() <span class="sc">+</span></span>
<span id="cb84-4"><a href="mitme-tunnuse-koosanalüüs.html#cb84-4" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">&quot;eq&quot;</span>, <span class="st">&quot;R2&quot;</span>))) <span class="sc">+</span></span>
<span id="cb84-5"><a href="mitme-tunnuse-koosanalüüs.html#cb84-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb84-6"><a href="mitme-tunnuse-koosanalüüs.html#cb84-6" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-60"></span>
<img src="_main_files/figure-html/unnamed-chunk-60-1.png" alt="Lineaarne regressioon" width="80%" />
<p class="caption">
Joonis 7.1: Lineaarne regressioon
</p>
</div>
<p>Järgnevalt käsu selgitus:</p>
<ul>
<li><p><code>ggplot(andmed, aes(x = d, y = h))</code>: See algatab ggplot-objekti, määrates andmestiku (data) ja esteetilised vastavused. See tähendab, et andmestiku veerg <code>d</code> vastendatakse x-teljega ja veerg <code>h</code> y-teljega.</p></li>
<li><p><code>stat_poly_line()</code>: See lisab graafikule polünoomilise regressioonijoone. Vaikimisi kasutab see lineaarset mudelit (astmega 1), kuid seda saab muuta, kasutades argumenti <code>formula</code>. Näiteks <code>stat_poly_line(formula = y ~ x^2)</code> lisaks graafikule ruutvõrrandi.</p></li>
<li><p><code>stat_poly_eq(use_label(c("eq", "R2")))</code>: See lisab graafikule polünoomilise regressioonivõrrandi ja R-ruudu väärtuse. <code>use_label()</code> funktsiooniga saab määrata, milliseid tunnuseid kuvatakse. Antud juhul kuvatakse võrrand (<code>eq</code>) ja R-ruut (<code>R2</code>).</p></li>
<li><p><code>geom_point()</code>: See lisab graafikule punktid, mis tähistavad andmepunkte.</p></li>
<li><p><code>xlim(c(10, 40))</code>: See seab x-telje piirid vahemikku 10 kuni 40.</p></li>
<li><p><code>ylim(c(10, 40))</code>: See seab y-telje piirid vahemikku 10 kuni 40.</p></li>
</ul>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="mitme-tunnuse-koosanalüüs.html#cb85-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb85-2"><a href="mitme-tunnuse-koosanalüüs.html#cb85-2" tabindex="-1"></a><span class="fu">ggplot</span>(andmed, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> h)) <span class="sc">+</span></span>
<span id="cb85-3"><a href="mitme-tunnuse-koosanalüüs.html#cb85-3" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">log</span>(x)) <span class="sc">+</span></span>
<span id="cb85-4"><a href="mitme-tunnuse-koosanalüüs.html#cb85-4" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">log</span>(x), <span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">&quot;eq&quot;</span>, <span class="st">&quot;R2&quot;</span>))) <span class="sc">+</span></span>
<span id="cb85-5"><a href="mitme-tunnuse-koosanalüüs.html#cb85-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb85-6"><a href="mitme-tunnuse-koosanalüüs.html#cb85-6" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-61"></span>
<img src="_main_files/figure-html/unnamed-chunk-61-1.png" alt="Lineaarne regressioon argumenttunnuse logistilise teisendusega" width="80%" />
<p class="caption">
Joonis 7.2: Lineaarne regressioon argumenttunnuse logistilise teisendusega
</p>
</div>
<p>R-is on võimalik lihtalt lisada mudelisse täiendavad tunnuseid, mis arvutakse otse mudeli arvutamise käigus ning seetõttu ei ole vajalik eraldi eelnevalt täiendavat tunnust välja arvutada. Funktsiooniga <code>I()</code> saab luua uusi tunnuseid olemasolevate tunnuste põhjal. Uus tunnus arvutatakse iga andmerea jaoks mudeli arvutamise käigus.</p>
<p>Järgnevas näites on muudetud mudelit: <code>lm(h ~ log(d)+I(pl == "MA"), data = andmed)</code></p>
<ul>
<li><strong><code>log(d)</code></strong>: Funktsioon <code>log()</code> arvutab <code>d</code> naturaallogaritmi, mis aitab lineariseerida seost diameetri ja kõrguse vahel.</li>
<li><strong><code>I(pl == "MA")</code></strong>: See on teine sõltumatu tunnus, mis luuakse jooksvalt funktsiooni <code>I()</code> abil. See on loogiline tunnus, mis on <code>TRUE</code>, kui tunnus <code>pl</code> väärtus on “MA” , ja <code>FALSE</code> vastasel juhul. Sisuliselt lisab see mudelisse teavet selle kohta, kas puu on mänd. Arvutustes kasutatakse antud tunnust vastavalt 1 või 0 väärtusena.</li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="mitme-tunnuse-koosanalüüs.html#cb86-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb86-2"><a href="mitme-tunnuse-koosanalüüs.html#cb86-2" tabindex="-1"></a><span class="co"># täiendatud argumenttunnustega regressioon</span></span>
<span id="cb86-3"><a href="mitme-tunnuse-koosanalüüs.html#cb86-3" tabindex="-1"></a><span class="fu">summary</span>(lm_model_pl <span class="ot">&lt;-</span> <span class="fu">lm</span>(h <span class="sc">~</span> <span class="fu">log</span>(d)<span class="sc">+</span><span class="fu">I</span>(pl <span class="sc">==</span> <span class="st">&quot;MA&quot;</span>), <span class="at">data =</span> andmed))</span></code></pre></div>
<pre><code>
Call:
lm(formula = h ~ log(d) + I(pl == &quot;MA&quot;), data = andmed)

Residuals:
   Min     1Q Median     3Q    Max 
-2,169 -0,857  0,048  0,665  3,421 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         -3,583      2,725   -1,31    0,195    
log(d)               8,924      0,872   10,24  3,2e-13 ***
I(pl == &quot;MA&quot;)TRUE   -0,978      0,430   -2,27    0,028 *  
---
Signif. codes:  0 &#39;***&#39; 0,001 &#39;**&#39; 0,01 &#39;*&#39; 0,05 &#39;.&#39; 0,1 &#39; &#39; 1

Residual standard error: 1,27 on 44 degrees of freedom
Multiple R-squared:  0,707, Adjusted R-squared:  0,694 
F-statistic: 53,2 on 2 and 44 DF,  p-value: 1,81e-12</code></pre>
<p>Antud juhul on näha, et mänd on teistest statistiliselt oluliselt erinev.</p>
</div>
<div id="lineaarne-regressioon-ms-exceli-keskkonnas" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Lineaarne regressioon MS Exceli keskkonnas<a href="mitme-tunnuse-koosanalüüs.html#lineaarne-regressioon-ms-exceli-keskkonnas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>MS Exceli keskkonnas saab lineaarse regressiooni parameetreid arvutada mitmel viisil.</p>
<ul>
<li>Kui argumenttunnuseid on vaid üks, siis saab kasutada funktsioone <code>intercept()</code> ja <code>slope()</code>.</li>
<li>Kui argumenttunnuseid on mitu (või ka ainult üks), siis saab kasutada funktsiooni <code>linest()</code>, mis annab tulemuseks juba ka täpsemad mudeli parameetrite hinnangud.</li>
<li>Ühe ja mitme argumenttunnuse puhul saab kasutada <em>Analysis Toolpak</em> protseduuri <em>Regression</em>.</li>
</ul>
<p>Avame faili <a href="data/naited.xlsx">naited.xlsx</a> töölehel “linreg”, kus on samad andmed nagu “prt_andmed”, aga sellel on juba välja filtreeritud ainult mudelpuude andmed. MS Exceli keskkonnas on üldiselt vajalik filtreeritud andmed viia eraldi tabelisse, et regressiooni käigus muid andmeid ei kasutataks.</p>
<p><em>Analysis Toolpak</em> abil regressioonanalüüsi tegemiseks tuleb menüüs “Andmed” valida “Data Analysis”, mis järel avaneb analüüsivahendite aken.</p>
<div class="float">
<img src="pildid/ms_excel_regression_step_1.png" alt="Data Analysis aken MS Excelis." />
<div class="figcaption">Data Analysis aken MS Excelis.</div>
</div>
<div class="float">
<img src="pildid/ms_excel_regression_step_2.png" style="width:80.0%" alt="Regressioonanalüüsi aken MS Excelis." />
<div class="figcaption">Regressioonanalüüsi aken MS Excelis.</div>
</div>
<p>Kordame samasugust analüüsi ka MS Exceli keskkonnas nagu R-is, arvutame diameetrist naturaallogaritmi funktsiooniga <code>ln()</code> ning kasutame <code>OnMänd</code> tunnust.</p>
<div class="float">
<img src="pildid/ms_excel_regression_step_3.png" style="width:80.0%" alt="Regressioonanalüüs kahe tunnuse alusel." />
<div class="figcaption">Regressioonanalüüs kahe tunnuse alusel.</div>
</div>
<p>Table: Lineaarse regressiooni tulemus MS Excelis.</p>
<p><strong>SUMMARY OUTPUT</strong></p>
<table>
<thead>
<tr class="header">
<th><strong>Regression Statistics</strong></th>
<th align="right"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Multiple R</td>
<td align="right">0,841</td>
</tr>
<tr class="even">
<td>R Square</td>
<td align="right">0,707</td>
</tr>
<tr class="odd">
<td>Adjusted R Square</td>
<td align="right">0,694</td>
</tr>
<tr class="even">
<td>Standard Error</td>
<td align="right">1,268</td>
</tr>
<tr class="odd">
<td>Observations</td>
<td align="right">47</td>
</tr>
</tbody>
</table>
<p><strong>ANOVA</strong></p>
<table>
<colgroup>
<col width="18%" />
<col width="11%" />
<col width="12%" />
<col width="11%" />
<col width="12%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="right"><strong>df</strong></th>
<th align="right"><strong>SS</strong></th>
<th align="right"><strong>MS</strong></th>
<th align="right"><strong>F</strong></th>
<th align="right"><strong>Significance F</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Regression</td>
<td align="right">2</td>
<td align="right">171,139</td>
<td align="right">85,570</td>
<td align="right">53,191</td>
<td align="right">0,000</td>
</tr>
<tr class="even">
<td>Residual</td>
<td align="right">44</td>
<td align="right">70,783</td>
<td align="right">1,609</td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td>Total</td>
<td align="right">46</td>
<td align="right">241,922</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
</tbody>
</table>
<table style="width:100%;">
<colgroup>
<col width="16%" />
<col width="24%" />
<col width="27%" />
<col width="15%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="right"><strong>Coefficients</strong></th>
<th align="right"><strong>Standard Error</strong></th>
<th align="right"><strong>t Stat</strong></th>
<th align="right"><strong>P-value</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Intercept</td>
<td align="right">-3,5829</td>
<td align="right">2,7247</td>
<td align="right">-1,3150</td>
<td align="right">0,1953</td>
</tr>
<tr class="even">
<td>log_d</td>
<td align="right">8,9235</td>
<td align="right">0,8718</td>
<td align="right">10,2358</td>
<td align="right">0,0000</td>
</tr>
<tr class="odd">
<td>OnMänd</td>
<td align="right">-0,9776</td>
<td align="right">0,4300</td>
<td align="right">-2,2737</td>
<td align="right">0,0279</td>
</tr>
</tbody>
</table>
</div>
<div id="regressioonanalüüsi-tulemuste-tõlgendamine" class="section level3 hasAnchor" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Regressioonanalüüsi tulemuste tõlgendamine<a href="#regressioonanal%C3%BC%C3%BCsi-tulemuste-t%C3%B5lgendamine" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lineaarse regressioonimudeli kokkuvõte sisaldab mitmeid olulisi statistilisi näitajaid, mis aitavad hinnata mudeli sobivust andmetele.</p>
<p>Determinatsioonikordaja, tuntud ka kui <span class="math inline">\(R^2\)</span> (R-ruut), on statistiline mõõdik, mida kasutatakse lineaarse regressiooni kontekstis, et hinnata, kui suures ulatuses argumenttunnuse variatsioon on seletatav sõltumatute tunnuste abil mudelis. <span class="math inline">\(R^2\)</span> väärtus varieerub vahemikus 0 kuni 1, kus 0 tähendab, et mudel ei seleta argumenttunnuse variatsiooni üldse, samas kui 1 tähendab, et mudel seletab argumenttunnuse variatsiooni täielikult.</p>
<p><span class="math inline">\(R^2\)</span> arvutamiseks kasutatakse järgmist valemit:</p>
<p><span class="math display">\[ R^2 = 1 - \frac{\text{SS}_\text{res}}{\text{SS}_\text{tot}} \]</span></p>
<p>kus:</p>
<ul>
<li><span class="math inline">\(\text{SS}_\text{res}\)</span> on jääkide ruutude summa (residual sum of squares), mis mõõdab mudeli poolt seletamata variatsiooni.</li>
<li><span class="math inline">\(\text{SS}_\text{tot}\)</span> on kogu variatsiooni ruutude summa (total sum of squares), mis mõõdab argumenttunnuse variatsiooni võrreldes tema keskmisega.</li>
</ul>
<p><strong>Kõrge <span class="math inline">\(R^2\)</span> väärtus</strong> (lähedane 1-le) näitab, et mudeli poolt seletatav variatsioon on suur, mis tähendab, et mudel sobib andmetele hästi. See viitab sellele, et suur osa argumenttunnuse variatsioonist on seletatav mudeli sõltumatute tunnustega.</p>
<p><strong>Madal <span class="math inline">\(R^2\)</span> väärtus</strong> (lähedane 0-le) näitab, et mudel seletab argumenttunnuse variatsioonist väikese osa, mis tähendab, et mudeli sobivus andmetele on kehv. See võib viidata sellele, et mudelis kasutatavad sõltumatud tunnused ei ole sõltuva tunnuse variatsiooni seletamisel tõhusad.</p>
<p>Oluline on mõista, et kuigi <span class="math inline">\(R^2\)</span> on kasulik mõõdik mudeli sobivuse hindamisel, ei tähenda kõrge <span class="math inline">\(R^2\)</span> automaatselt, et mudel on õige või, et argumenttunnused põhjustavad funktsioontunnuse käitumist. Samuti ei pruugi madal <span class="math inline">\(R^2\)</span> alati tähendada mudeli ebatõhusust, eriti keerukamate või mittelineaarsete suhete puhul. Lisaks tuleks mudeli hindamisel arvesse võtta ka muid tegureid, nagu mudeli tõlgendatavus, argumenttunnuste olulisus ja korrigeeritud <span class="math inline">\(R^2\)</span>.</p>
<p>Lineaarse regressioonimudeli <strong>nihutamata hinnang</strong>, tuntud ka kui korrigeeritud <span class="math inline">\(R^2\)</span> (inglise keeles “adjusted <span class="math inline">\(R^2\)</span>”), on statistiline mõõdik, mida kasutatakse mudeli seletusvõime hindamiseks, võttes arvesse mudeli sõltumatute tunnuste arvu. Erinevalt lihtsast <span class="math inline">\(R^2\)</span>-st, mis mõõdab, kui suur osa argumenttunnuse variatsioonist on seletatav mudeli abil, arvestab korrigeeritud <span class="math inline">\(R^2\)</span> mudeli keerukust, arvestab mudeli liigsete sõltumatute tunnuste lisamise eest. See on oluline, kuna mudelisse liiga palju tunnusid lisades võib <span class="math inline">\(R^2\)</span> väärtus eksitavalt tõusta, viidates paremale mudeli sobivusele, kuigi tegelikult võivad lisatud tunnused olla statistiliselt mitteolulised.</p>
<p>Korrigeeritud <span class="math inline">\(R^2\)</span> arvutatakse järgmise valemi järgi:</p>
<p><span class="math display">\[ R^2_{\text{adj}} = 1 - \left( \frac{(1 - R^2)(n - 1)}{n - k - 1} \right) \]</span></p>
<p>kus:</p>
<ul>
<li><span class="math inline">\(R^2\)</span> on mudeli lihtne determinatsioonikoefitsient,</li>
<li><span class="math inline">\(n\)</span> on vaatluste arv,</li>
<li><span class="math inline">\(k\)</span> on sõltumatute tunnuste arv mudelis.</li>
</ul>
<p>Valemist nähtub, et <span class="math inline">\(R^2_{\text{adj}}\)</span> väheneb, kui lisatakse tunnusid, mis ei paranda mudeli seletusvõimet proportsionaalselt nende arvuga. Seega, erinevalt lihtsast <span class="math inline">\(R^2\)</span>-st, pakub korrigeeritud <span class="math inline">\(R^2\)</span> ausamat hinnangut mudeli sobivusele, eriti kui võrrelda mudeleid, mis sisaldavad erinevat arvu sõltumatuid tunnusid. Korrigeeritud <span class="math inline">\(R^2\)</span> on eriti kasulik mudelite võrdlemisel ja mudeli valimisel, aidates vältida ülemudelitamist ja eelistades mudelit, mis annab parima tasakaalu seletusvõime ja keerukuse vahel.</p>
<ul>
<li><p>P-väärtused näitavad, kas argumenttunnus on statistiliselt oluline mudelis. Kui P-väärtus on väiksem kui 0,05, siis võib järeldada, et argumenttunnus mõjutab oluliselt sõltuvat tunnust.</p></li>
<li><p>Regressioonikordaja väärtused annavad teavet sõltumatute tunnuste mõju kohta sõltuvale tunnusle.</p></li>
</ul>
<p>Kokkuvõttes aitab väljund mõista, kuidas mudel sobitub andmetega ja millist infot see pakub sõltuvate ja sõltumatute tunnuste seoste kohta.</p>
</div>
<div id="homoskedastilisuse-testimine" class="section level3 hasAnchor" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> Homoskedastilisuse testimine<a href="mitme-tunnuse-koosanalüüs.html#homoskedastilisuse-testimine" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Statistilise regressioonimudeli kontekstis viitab homoskedastiivsus olukorrale, kus jääkliikmete (ehk mudeli veatermini) dispersioon on konstantne sõltumata seletavate muutujate väärtustest. See tähendab, et mudeli ennustusvead on ühtlase hajuvusega kogu vaadeldava andmevahemiku ulatuses, ega ole süstemaatiliselt seotud ennustatud väärtustega. Homoskedastiivsus on kriitiline eeldus mitmetes statistilistes meetodites, eriti vähimruutude meetodil baseeruva lineaarse regressiooni puhul. Selle eelduse rikkumine, tuntud kui heteroskedastiivsus, võib moonutada mudeli parameetrite hinnanguid, viies ebatäpsete usaldusvahemike ja potentsiaalselt vigaste järeldusteni hüpoteeside testimisel.</p>
<p>On mitmeid viise, kuidas testida, kas andmetes esineb homoskedastiivsust:</p>
<ol style="list-style-type: decimal">
<li><strong>Visuaalne analüüs:</strong> Lihtsaim viis on vaadata jääkliikmete graafikut seletavate muutujate või ennustatud väärtuste suhtes. Kui jääkliikmed on ühtlaselt hajunud nulljoone ümber, on homoskedastiivsus tõenäoline. Kui tekib mingi muster (näiteks koonusekujuline hajumine), on tõenäoline heteroskedastiivsus.</li>
<li><strong>Formaliseeritud testid:</strong> On olemas mitmed statistilised testid, näiteks Breusch-Pagani test ja White’i test, mis testivad heteroskedastiivsust formaalselt. Need testid kontrollivad, kas jääkliikmete dispersioon on seotud seletavate muutujatega.</li>
<li><strong>Robustsed meetodid:</strong> Kui andmetes esineb heteroskedastiivsust, võib kasutada robustseid regressioonimeetodeid, mis on vähem tundlikud heteroskedastiivsuse suhtes.</li>
</ol>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="mitme-tunnuse-koosanalüüs.html#cb88-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb88-2"><a href="mitme-tunnuse-koosanalüüs.html#cb88-2" tabindex="-1"></a><span class="fu">plot</span>(lm_model, <span class="at">which=</span><span class="dv">1</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-63"></span>
<img src="_main_files/figure-html/unnamed-chunk-63-1.png" alt="Jäägid vs prognoositud väärtus" width="80%" />
<p class="caption">
Joonis 7.3: Jäägid vs prognoositud väärtus
</p>
</div>
<p>Lineaarse mudeli homoskedastilisuse testimiseks saab kasutada Breush-Pagan või White’i testi. Need testid hindavad, kas jääkide varieeruvus on seotud sõltumatute tunnustega ning kas see varieeruvus on ühtlane.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="mitme-tunnuse-koosanalüüs.html#cb89-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb89-2"><a href="mitme-tunnuse-koosanalüüs.html#cb89-2" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">bptest</span>(lm_model)</span></code></pre></div>
<pre><code>
    studentized Breusch-Pagan test

data:  lm_model
BP = 0,9, df = 1, p-value = 0,4</code></pre>
<p>Paketi <code>lmtest</code> funktsioon <code>bptest()</code> testib regressioonimudeli jääkide heteroskedastsuse olemasolu. See tähendab, et jääkide varieeruvus ei ole konstantne üle kõigi sõltumatute tunnuste väärtuste ning võib tekitada probleeme statistiliste hüpoteeside testimisel.</p>
<p>Testi tulemusi võib lugeda järgmiselt:</p>
<ul>
<li>Nullhüpotees (H0): jääkide varieeruvus on konstantne (st heteroskedastsust ei esine).</li>
<li>Alternatiivhüpotees (H1): jääkide varieeruvus ei ole konstantne (st heteroskedastsus esineb).</li>
</ul>
<p>Testist saadav p-väärtus aitab hinnata, kas on piisavalt tõendeid, et lükata ümber nullhüpotees heteroskedastsuse puudumise kohta. Väike p-väärtus (&lt;0,05) viitab sellele, et saame nullhüpoteesi ümber lükata ja järeldada, et heteroskedastsust esineb.</p>
</div>
<div id="jääkide-normaalsuse-test" class="section level3 hasAnchor" number="7.1.5">
<h3><span class="header-section-number">7.1.5</span> Jääkide normaalsuse test<a href="#j%C3%A4%C3%A4kide-normaalsuse-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Üks oluline eeldus, mida lineaarses regressioonis kasutatakse, on see, et mudeli jäägid vastaksid normaaljaotusele. Normaaljaotus tähendab, et andmete jaotus on sümmeetriline ning keskmise jaotusega. Kui jäägid on normaaljaotusele lähedased, siis on regressioonimudeli ennustused usaldusväärsemad ja täpsemad. Paljud statistilised testid eeldavad, et andmed vastavad normaaljaotusele. Kui jäägid ei vasta normaaljaotusele, võivad testide tulemused olla ebatäpsed või valed. Normaaljaotuse eeldustele mitte vastamine võib viidata sellele, et mudel ei sobi antud andmetele hästi ning on vajalik leida alternatiivseid mudeleid.</p>
<p>Normaliseeritud jääkide graafik on üks viis, kuidas hinnata, kas jäägid vastavad normaaljaotusele. See graafik aitab visualiseerida, kas jäägid on juhuslikult hajutatud ümber nulli ja kas nende jaotus on ligilähedane normaaljaotusele.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="mitme-tunnuse-koosanalüüs.html#cb91-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb91-2"><a href="mitme-tunnuse-koosanalüüs.html#cb91-2" tabindex="-1"></a></span>
<span id="cb91-3"><a href="mitme-tunnuse-koosanalüüs.html#cb91-3" tabindex="-1"></a><span class="fu">ggplot</span>(lm_model, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb91-4"><a href="mitme-tunnuse-koosanalüüs.html#cb91-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb91-5"><a href="mitme-tunnuse-koosanalüüs.html#cb91-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb91-6"><a href="mitme-tunnuse-koosanalüüs.html#cb91-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x))  <span class="co"># Lisab sujuva joone GAM mudeli abil</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-65-1.png" width="80%" />
Koodi selgitus:</p>
<p><strong><code>ggplot(lm_model, aes(x = .fitted, y = .resid))</code></strong></p>
<ul>
<li>See käsk loob aluse graafikule ggplot2 paketiga.</li>
<li><code>lm_model</code> määrab andmeallika, milleks on lineaarne mudel.</li>
<li><code>aes(x = .fitted, y = .resid)</code> määrab x-teljele mudeli sobitatud väärtused (.fitted) ja y-teljele jääkväärtused (.resid).</li>
</ul>
<p><strong><code>geom_point()</code></strong></p>
<ul>
<li>See lisab graafikule punktid, mis esindavad iga andmepunkti jääki ja sobitatud väärtust.</li>
</ul>
<p><strong><code>geom_hline(yintercept = 0)</code></strong></p>
<ul>
<li>See lisab horisontaalse joone y-telje väärtusel 0. See joon aitab visuaalselt hinnata jääkide jaotust - ideaalses mudelis peaksid punktid jaotuma ühtlaselt joone ümber.</li>
</ul>
<p><strong><code>geom_smooth(method = "gam", formula = y ~ s(x))</code></strong></p>
<ul>
<li>See lisab graafikule sujuva joone, mis on arvutatud GAM mudeli (Generalized Additive Model) abil.</li>
<li><code>method = "gam"</code> määrab joone arvutamise meetodiks GAM.</li>
<li><code>formula = y ~ s(x)</code> määrab mudeli valemi, kus y (jääkväärtused) on seotud x-i (sobitatud väärtused) sujuva funktsiooniga s(x).</li>
</ul>
<p><strong>Kokkuvõtteks:</strong></p>
<p>Kood genereerib diagnostilise graafiku, mis aitab hinnata lineaarse mudeli sobivust andmetega. Jääkide jaotus 0-joone ümber ja sujuva joone kuju annavad informatsiooni mudeli eelduste (nt homoskedastsus ja lineaarsus) täidetuse kohta.</p>
<p>Samuti saab vaadata jääkide jagunemist tihedusfunktsiooni abil koostatud graafikul.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="mitme-tunnuse-koosanalüüs.html#cb92-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb92-2"><a href="mitme-tunnuse-koosanalüüs.html#cb92-2" tabindex="-1"></a></span>
<span id="cb92-3"><a href="mitme-tunnuse-koosanalüüs.html#cb92-3" tabindex="-1"></a><span class="fu">ggplot</span>(lm_model, <span class="fu">aes</span>(<span class="at">x =</span> .resid)) <span class="sc">+</span></span>
<span id="cb92-4"><a href="mitme-tunnuse-koosanalüüs.html#cb92-4" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-66"></span>
<img src="_main_files/figure-html/unnamed-chunk-66-1.png" alt="Jääkide tihedusfunktsioon" width="80%" />
<p class="caption">
Joonis 7.4: Jääkide tihedusfunktsioon
</p>
</div>
<p>Sellise protseduuri abil saad hinnata, kui hästi sobib loodud lineaarne regressioonimudel andmetele ning kas jääkide jaotus vastab normaalsuse eeldusele.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="mitme-tunnuse-koosanalüüs.html#cb93-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb93-2"><a href="mitme-tunnuse-koosanalüüs.html#cb93-2" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb93-3"><a href="mitme-tunnuse-koosanalüüs.html#cb93-3" tabindex="-1"></a><span class="fu">anova</span>(lm_model)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: h
          Df Sum Sq Mean Sq F value  Pr(&gt;F)    
d          1  158,5   158,5    85,5 5,7e-12 ***
Residuals 45   83,4     1,9                    
---
Signif. codes:  0 &#39;***&#39; 0,001 &#39;**&#39; 0,01 &#39;*&#39; 0,05 &#39;.&#39; 0,1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="mitme-tunnuse-koosanalüüs.html#cb95-1" tabindex="-1"></a><span class="fu">confint</span>(lm_model)</span></code></pre></div>
<pre><code>            2,5 % 97,5 %
(Intercept) 14,49 18,099
d            0,26  0,405</code></pre>
</div>
<div id="multikollineaarsus" class="section level3 hasAnchor" number="7.1.6">
<h3><span class="header-section-number">7.1.6</span> Multikollineaarsus<a href="mitme-tunnuse-koosanalüüs.html#multikollineaarsus" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lineaarses regressioonis tähistab multikollineaarsus olukorda, kus kaks või enam sõltumatut tunnust (selgitajat) on omavahel tugevalt seotud või korreleerunud. See tähendab, et ühe selgitaja väärtusi saab suure täpsusega ennustada teiste selgitajate väärtuste põhjal. Multikollineaarsus võib olla probleemiks, sest:</p>
<p>Mõjutab koefitsientide hinnangute täpsust: multikollineaarsus suurendab koefitsientide hinnangute varieeruvust, mis muudab need ebastabiilseks. Väiksed muudatused andmestikus võivad tuua kaasa suuri muutusi koefitsientide hinnangutes, muutes mudeli interpretatsiooni keeruliseks.</p>
<p>Raskendab tunnuste tähtsuse hindamist: kõrge multikollineaarsuse korral võib olla raske kindlaks teha, milline argumenttunnus mõjutab sõltuvat tunnust, sest statistilised testid ei pruugi olla usaldusväärsed. See võib viia oluliste tunnuste ebaõiglase kõrvalejätmiseni või ebaoluliste tunnuste mudelisse lisamiseni.</p>
<p>Vähendab mudeli interpretatsiooni selgust: kui argumenttunnused on omavahel tugevalt seotud, muutub mudeli interpretatsioon keerulisemaks, kuna keeruline on eristada iga tunnus unikaalset mõju argumenttunnusele .</p>
<p>Multikollineaarsuse tuvastamiseks lineaarses regressioonis kasutatakse tavaliselt järgmisi meetodeid:</p>
<ul>
<li><strong>Korrelatsioonimatriks</strong>: Vaadeldakse sõltumatute tunnuste vahelisi korrelatsioonikoefitsiente. Kõrge korrelatsioon näitab võimalikku multikollineaarsust.</li>
<li><strong>Variance Inflation Factor (VIF)</strong>: VIF mõõdab, kui palju tunnus variatiivsus suureneb multikollineaarsuse tõttu. Tavaliselt peetakse VIF väärtust üle 5 või 10 viitavaks tugevale multikollineaarsusele.</li>
<li><strong>Tolerants</strong>: Tolerants on VIF-i pöördväärtus ja näitab, kui suur osa tunnus variatsioonist ei ole seletatav teiste mudeli tunnustega. Madal tolerants viitab multikollineaarsusele.</li>
</ul>
<p>Multikollineaarsuse lahendamiseks võib kasutada mitmeid lähenemisviise, näiteks tunnuste eemaldamist mudelist, tunnuste kombineerimist või andmete transformeerimist. Samuti võib kasulikuks osutuda regulaarimismeetodite, nagu ridge regressioon või lasso regressioon, kasutamine, mis aitavad vähendada koefitsientide varieeruvust, karistades suuri koefitsiente.</p>
<p>Vaatame järgmist näidet, kus puude kõrgust ennustame mõlema diameetri alusel. Kui varasemalt oli näha, et üks diameeter on oluline, siis antud mudelid ei ole enam kumbki oluline, sest nende tunnuse vahel on korrelatsioon.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="mitme-tunnuse-koosanalüüs.html#cb97-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb97-2"><a href="mitme-tunnuse-koosanalüüs.html#cb97-2" tabindex="-1"></a><span class="fu">summary</span>(lm.col <span class="ot">&lt;-</span> <span class="fu">lm</span>(h <span class="sc">~</span> d1 <span class="sc">+</span> d2, <span class="at">data =</span> andmed))</span></code></pre></div>
<pre><code>
Call:
lm(formula = h ~ d1 + d2, data = andmed)

Residuals:
   Min     1Q Median     3Q    Max 
-2,709 -0,893 -0,200  0,787  3,143 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  16,1390     0,8902   18,13   &lt;2e-16 ***
d1           -0,0231     0,2431   -0,09     0,92    
d2            0,3643     0,2466    1,48     0,15    
---
Signif. codes:  0 &#39;***&#39; 0,001 &#39;**&#39; 0,01 &#39;*&#39; 0,05 &#39;.&#39; 0,1 &#39; &#39; 1

Residual standard error: 1,34 on 44 degrees of freedom
Multiple R-squared:  0,671, Adjusted R-squared:  0,656 
F-statistic:   45 on 2 and 44 DF,  p-value: 2,32e-11</code></pre>
<p>Tehes täiendavalt ANOVA, on näha, et diameeter, mis lineaarses regressioonimudelis ei olnud oluline, on dispersioonanalüüsi järgi peamine varieeruvuse kirjeldaja.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="mitme-tunnuse-koosanalüüs.html#cb99-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb99-2"><a href="mitme-tunnuse-koosanalüüs.html#cb99-2" tabindex="-1"></a><span class="fu">anova</span>(lm.col)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: h
          Df Sum Sq Mean Sq F value  Pr(&gt;F)    
d1         1  158,5   158,5   87,73 4,8e-12 ***
d2         1    3,9     3,9    2,18    0,15    
Residuals 44   79,5     1,8                    
---
Signif. codes:  0 &#39;***&#39; 0,001 &#39;**&#39; 0,01 &#39;*&#39; 0,05 &#39;.&#39; 0,1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="mitme-tunnuse-koosanalüüs.html#cb101-1" tabindex="-1"></a><span class="co"># Arvutame VIF väärtuse multikollineaarsuse tuvastamiseks</span></span>
<span id="cb101-2"><a href="mitme-tunnuse-koosanalüüs.html#cb101-2" tabindex="-1"></a><span class="fu">vif</span>(lm.col)</span></code></pre></div>
<pre><code>d1 d2 
47 47 </code></pre>
<p>Kui VIF väärtus on üle 5, siis on tunnuste vahel tugev korrelatsioon, mida saame kontrollida ka korrelatsioonimaatriksiga.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="mitme-tunnuse-koosanalüüs.html#cb103-1" tabindex="-1"></a><span class="co"># Näide R keskkonnas</span></span>
<span id="cb103-2"><a href="mitme-tunnuse-koosanalüüs.html#cb103-2" tabindex="-1"></a><span class="fu">cor</span>(andmed[,<span class="fu">c</span>(<span class="st">&quot;d1&quot;</span>,<span class="st">&quot;d2&quot;</span>)])</span></code></pre></div>
<pre><code>      d1    d2
d1 1,000 0,989
d2 0,989 1,000</code></pre>
<p>Sellest on näha, et need on tugevas korrelatsioonis (0,986). See mõjutab ka lineaarse regressiooni parameetrite arvutamist.</p>
</div>
</div>
<div id="dispersioonanalüüs" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Dispersioonanalüüs<a href="#dispersioonanal%C3%BC%C3%BCs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Mitmese regressioonanalüüsi korral on tegemist mudeliga, kus pidev funktsioontunnus avaldub pidevate argumenttunnuste lineaarkombinatsioonina. Dispersioonanalüüsi korral on tegemist mudelitega, kus funktsioontunnuseks on pidev tunnus, kuid argument-tunnused on diskreetsed (võivad olla nii arvulised kui ka mittearvulised). Dispersioon-analüüsi argumenttunnuseid nimetatakse faktoriteks. Ühefaktorilise dispersioonanalüüsi puhul uuritakse funktsioontunnuse sõltuvust ainult ühest faktorist. Faktori võimalikke väärtusi nimetatakse faktori tasemeteks.</p>
<p>Olgu üldkogum jaotatud mittelõikuvateks osadeks ehk rühmadeks faktori tasemete järgi. Öeldakse, et faktor X mõjub tunnusele Y, kui tunnuse Y keskväärtused eri rühmades on erinevad. Uurija käsutuses on valimi mõõtmisandmed, mille funktsioon-tunnuse rühmakeskmised tavaliselt erinevad. Dispersioonanalüüs on meetod, millega otsitakse vastust küsimusele, kas valimi rühmakeskmiste erinevus on põhjustatud uuritava faktori mõjust või valimi juhuslikkusest.</p>
<p>Dispersioonanalüüsi võimalused ja vahendid sõltuvad oluliselt valitud mudelist ja katsekorraldusest. Kui iga faktortunnuse igal tasemel on tehtud ühepalju mõõtmisi, nimetatakse mudelit tasakaalustatuks, vastasel juhul on tegemist tasakaalustamata mudeliga. Kui mõõtmisi on tehtud faktori kõigil võimalikel tasemetel, siis nimetatakse seda fikseeritud faktoriks. Kui faktortunnusel on palju erinevaid väärtusi ja mõõdetud tasemeid vaadeldakse juhusliku valimina faktori võimalike tasemete hulgast, siis nimetatakse seda juhuslikuks faktoriks. Järgnevalt käsitleme ainult fikseeritud faktoritega mudeleid.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistilised-hinnangud.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mittelineaarne-regressioon.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"caption": {
"figure_num_sep": ".",
"table_num_sep": "."
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
