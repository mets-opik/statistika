<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Peatükk 8 Mittelineaarne regressioon | Metsanduslik statistika R ja MS Excel keskkonnas</title>
  <meta name="description" content="Peatükk 8 Mittelineaarne regressioon | Metsanduslik statistika R ja MS Excel keskkonnas" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Peatükk 8 Mittelineaarne regressioon | Metsanduslik statistika R ja MS Excel keskkonnas" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Peatükk 8 Mittelineaarne regressioon | Metsanduslik statistika R ja MS Excel keskkonnas" />
  <meta name="github-repo" content="xyzallan/met-stat-opik" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Peatükk 8 Mittelineaarne regressioon | Metsanduslik statistika R ja MS Excel keskkonnas" />
  
  <meta name="twitter:description" content="Peatükk 8 Mittelineaarne regressioon | Metsanduslik statistika R ja MS Excel keskkonnas" />
  

<meta name="author" content="Allan Sims, Andres Kiviste, Diana Laarmann" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mitme-tunnuse-koosanalüüs.html"/>
<link rel="next" href="mitteparameetriline-analüüs.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Sissejuhatus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#statistikaprogramm-r"><i class="fa fa-check"></i><b>1.1</b> Statistikaprogramm R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#r-i-paketid"><i class="fa fa-check"></i><b>1.1.1</b> R-i paketid</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#ms-excel"><i class="fa fa-check"></i><b>1.2</b> MS Excel</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="andmestik.html"><a href="andmestik.html"><i class="fa fa-check"></i><b>2</b> Andmestik</a>
<ul>
<li class="chapter" data-level="2.1" data-path="andmestik.html"><a href="andmestik.html#andmestiku-struktuur-r-keskkonnas"><i class="fa fa-check"></i><b>2.1</b> Andmestiku struktuur R keskkonnas</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="andmestik.html"><a href="andmestik.html#vektor"><i class="fa fa-check"></i><b>2.1.1</b> Vektor</a></li>
<li class="chapter" data-level="2.1.2" data-path="andmestik.html"><a href="andmestik.html#maatriks"><i class="fa fa-check"></i><b>2.1.2</b> Maatriks</a></li>
<li class="chapter" data-level="2.1.3" data-path="andmestik.html"><a href="andmestik.html#andmetabel"><i class="fa fa-check"></i><b>2.1.3</b> Andmetabel</a></li>
<li class="chapter" data-level="2.1.4" data-path="andmestik.html"><a href="andmestik.html#list"><i class="fa fa-check"></i><b>2.1.4</b> List</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="andmestik.html"><a href="andmestik.html#andmestike-importimine-r-keskkonda"><i class="fa fa-check"></i><b>2.2</b> Andmestike importimine R keskkonda</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="08-mittelineaarne.html"><a href="#andmestike-r%C3%BChmitamine"><i class="fa fa-check"></i><b>3</b> Andmestike rühmitamine</a>
<ul>
<li class="chapter" data-level="3.1" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html"><i class="fa fa-check"></i><b>3.1</b> Jaotused</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#empiiriline-jaotus"><i class="fa fa-check"></i><b>3.1.1</b> Empiiriline jaotus</a></li>
<li class="chapter" data-level="3.1.2" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#teoreetiline-jaotus"><i class="fa fa-check"></i><b>3.1.2</b> Teoreetiline jaotus</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#histogramm"><i class="fa fa-check"></i><b>3.2</b> Histogramm</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#r-keskkonnas"><i class="fa fa-check"></i><b>3.2.1</b> R keskkonnas:</a></li>
<li class="chapter" data-level="3.2.2" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#exceli-keskkonnas"><i class="fa fa-check"></i><b>3.2.2</b> Exceli keskkonnas:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="karakteristikud.html"><a href="karakteristikud.html"><i class="fa fa-check"></i><b>4</b> Karakteristikud</a>
<ul>
<li class="chapter" data-level="4.1" data-path="karakteristikud.html"><a href="karakteristikud.html#keskmised"><i class="fa fa-check"></i><b>4.1</b> Keskmised</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="karakteristikud.html"><a href="karakteristikud.html#aritmeetiline-keskmine"><i class="fa fa-check"></i><b>4.1.1</b> Aritmeetiline keskmine</a></li>
<li class="chapter" data-level="4.1.2" data-path="karakteristikud.html"><a href="karakteristikud.html#ruutkeskmine"><i class="fa fa-check"></i><b>4.1.2</b> Ruutkeskmine</a></li>
<li class="chapter" data-level="4.1.3" data-path="karakteristikud.html"><a href="karakteristikud.html#geomeetriline-keskmine"><i class="fa fa-check"></i><b>4.1.3</b> Geomeetriline keskmine</a></li>
<li class="chapter" data-level="4.1.4" data-path="karakteristikud.html"><a href="karakteristikud.html#harmooniline-keskmine"><i class="fa fa-check"></i><b>4.1.4</b> Harmooniline keskmine</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="karakteristikud.html"><a href="karakteristikud.html#kvantiilid"><i class="fa fa-check"></i><b>4.2</b> Kvantiilid</a></li>
<li class="chapter" data-level="4.3" data-path="karakteristikud.html"><a href="karakteristikud.html#mediaan"><i class="fa fa-check"></i><b>4.3</b> Mediaan</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html"><i class="fa fa-check"></i><b>5</b> Jaotusfunktsioonid</a>
<ul>
<li class="chapter" data-level="5.1" data-path="08-mittelineaarne.html"><a href="#h%C3%BCpotees"><i class="fa fa-check"></i><b>5.1</b> Hüpotees</a></li>
<li class="chapter" data-level="5.2" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#jaotusfunktsioon"><i class="fa fa-check"></i><b>5.2</b> Jaotusfunktsioon</a></li>
<li class="chapter" data-level="5.3" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#normaaljaotus"><i class="fa fa-check"></i><b>5.3</b> Normaaljaotus</a></li>
<li class="chapter" data-level="5.4" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#t-jaotus"><i class="fa fa-check"></i><b>5.4</b> T-jaotus</a></li>
<li class="chapter" data-level="5.5" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#f-jaotus"><i class="fa fa-check"></i><b>5.5</b> F-jaotus</a></li>
<li class="chapter" data-level="5.6" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#chi2-jaotus-hii-ruut-jaotus"><i class="fa fa-check"></i><b>5.6</b> <span class="math inline">\(\chi^2\)</span>-jaotus (hii-ruut-jaotus)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html"><i class="fa fa-check"></i><b>6</b> Statistilised hinnangud</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#punkthinnangud"><i class="fa fa-check"></i><b>6.1</b> Punkthinnangud</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#valimi-maht"><i class="fa fa-check"></i><b>6.1.1</b> Valimi maht</a></li>
<li class="chapter" data-level="6.1.2" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#aritmeetiline-keskmine-1"><i class="fa fa-check"></i><b>6.1.2</b> Aritmeetiline keskmine</a></li>
<li class="chapter" data-level="6.1.3" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#dispersioon"><i class="fa fa-check"></i><b>6.1.3</b> Dispersioon</a></li>
<li class="chapter" data-level="6.1.4" data-path="08-mittelineaarne.html"><a href="#standardh%C3%A4lve"><i class="fa fa-check"></i><b>6.1.4</b> Standardhälve</a></li>
<li class="chapter" data-level="6.1.5" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#standardviga"><i class="fa fa-check"></i><b>6.1.5</b> Standardviga</a></li>
<li class="chapter" data-level="6.1.6" data-path="08-mittelineaarne.html"><a href="#katset%C3%A4psus"><i class="fa fa-check"></i><b>6.1.6</b> Katsetäpsus</a></li>
<li class="chapter" data-level="6.1.7" data-path="08-mittelineaarne.html"><a href="#standardh%C3%A4lbe-viga"><i class="fa fa-check"></i><b>6.1.7</b> Standardhälbe viga</a></li>
<li class="chapter" data-level="6.1.8" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#dispersiooni-viga"><i class="fa fa-check"></i><b>6.1.8</b> Dispersiooni viga</a></li>
<li class="chapter" data-level="6.1.9" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#variatsioonikordaja"><i class="fa fa-check"></i><b>6.1.9</b> Variatsioonikordaja</a></li>
<li class="chapter" data-level="6.1.10" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#variatsioonikordaja-viga"><i class="fa fa-check"></i><b>6.1.10</b> Variatsioonikordaja viga</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#vahemikhinnangud"><i class="fa fa-check"></i><b>6.2</b> Vahemikhinnangud</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="08-mittelineaarne.html"><a href="#keskv%C3%A4%C3%A4rtuse-usalduspiirid"><i class="fa fa-check"></i><b>6.2.1</b> Keskväärtuse usalduspiirid</a></li>
<li class="chapter" data-level="6.2.2" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#dispersiooni-usalduspiirid"><i class="fa fa-check"></i><b>6.2.2</b> Dispersiooni usalduspiirid</a></li>
<li class="chapter" data-level="6.2.3" data-path="08-mittelineaarne.html"><a href="#standardh%C3%A4lbe-usalduspiirid"><i class="fa fa-check"></i><b>6.2.3</b> Standardhälbe usalduspiirid</a></li>
<li class="chapter" data-level="6.2.4" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#binoomjaotuse-parameetri-p-usalduspiirid"><i class="fa fa-check"></i><b>6.2.4</b> Binoomjaotuse parameetri p usalduspiirid</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#valimi-mahu-hindamine"><i class="fa fa-check"></i><b>6.3</b> Valimi mahu hindamine</a></li>
<li class="chapter" data-level="6.4" data-path="08-mittelineaarne.html"><a href="#statistilised-h%C3%BCpoteesid"><i class="fa fa-check"></i><b>6.4</b> Statistilised hüpoteesid</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="08-mittelineaarne.html"><a href="#f-test-normaaljaotusega-%C3%BCldkogumite-dispersioonide-v%C3%B5rdlemiseks"><i class="fa fa-check"></i><b>6.4.1</b> F-test normaaljaotusega üldkogumite dispersioonide võrdlemiseks</a></li>
<li class="chapter" data-level="6.4.2" data-path="08-mittelineaarne.html"><a href="#keskmiste-v%C3%B5rdlemine-paarikaupa-andmete-korral-normaaljaotusega-%C3%BCldkogumist"><i class="fa fa-check"></i><b>6.4.2</b> Keskmiste võrdlemine paarikaupa andmete korral normaaljaotusega üldkogumist</a></li>
<li class="chapter" data-level="6.4.3" data-path="08-mittelineaarne.html"><a href="#s%C3%B5ltumatuse-hii-ruut-test"><i class="fa fa-check"></i><b>6.4.3</b> Sõltumatuse hii-ruut-test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="08-mittelineaarne.html"><a href="#mitme-tunnuse-koosanal%C3%BC%C3%BCs"><i class="fa fa-check"></i><b>7</b> Mitme tunnuse koosanalüüs</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mitme-tunnuse-koosanalüüs.html"><a href="mitme-tunnuse-koosanalüüs.html"><i class="fa fa-check"></i><b>7.1</b> Lineaarne regressioon</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mittelineaarne-regressioon.html"><a href="mittelineaarne-regressioon.html"><i class="fa fa-check"></i><b>8</b> Mittelineaarne regressioon</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mittelineaarne-regressioon.html"><a href="mittelineaarne-regressioon.html#r"><i class="fa fa-check"></i><b>8.1</b> R</a></li>
<li class="chapter" data-level="8.2" data-path="mittelineaarne-regressioon.html"><a href="mittelineaarne-regressioon.html#ms-excel-1"><i class="fa fa-check"></i><b>8.2</b> MS Excel</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="08-mittelineaarne.html"><a href="#mitteparameetriline-anal%C3%BC%C3%BCs"><i class="fa fa-check"></i><b>9</b> Mitteparameetriline analüüs</a>
<ul>
<li class="chapter" data-level="9.1" data-path="08-mittelineaarne.html"><a href="#%C3%BCldistatud-aditiivne-mudel"><i class="fa fa-check"></i><b>9.1</b> Üldistatud aditiivne mudel</a></li>
<li class="chapter" data-level="9.2" data-path="mitteparameetriline-analüüs.html"><a href="mitteparameetriline-analüüs.html"><i class="fa fa-check"></i><b>9.2</b> Visualiseerimine paketiga <code>ggplot2</code></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Metsanduslik statistika R ja MS Excel keskkonnas</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mittelineaarne-regressioon" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Peatükk 8</span> Mittelineaarne regressioon<a href="mittelineaarne-regressioon.html#mittelineaarne-regressioon" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Mittelineaarne regressioon</strong> on statistiline meetod, mida kasutatakse sõltuva muutuja ja ühe või mitme sõltumatu muutuja vahelise mittelineaarse seose modelleerimiseks. Erinevalt lineaarsest regressioonist, mis eeldab sirgjoonelist seost, võimaldab mittelineaarne regressioon paindlikumaid seoseid, näiteks kõverjoonelisi, eksponentsiaalseid või logistilisi seoseid.</p>
<p>Metsanduses esineb sageli mittelineaarseid seoseid. Mittelineaarne regressioon võimaldab neid keerukaid seoseid täpsemalt modelleerida ja paremini mõista.</p>
<p>Mittelineaarne regressioonimudel kirjutatakse üldjuhul kujul:</p>
<p><span class="math display">\[Y = f(X, \beta) + \epsilon\]</span></p>
<p>kus:</p>
<ul>
<li><strong>Y</strong> on sõltuv muutuja.</li>
<li><strong>X</strong> on sõltumatu(te) muutuja(te) vektor.</li>
<li><strong><span class="math inline">\(f(X, \beta)\)</span></strong> on mittelineaarne funktsioon, mis kirjeldab seost X ja Y vahel.</li>
<li><strong><span class="math inline">\(\beta\)</span></strong> on mudeli parameetrite vektor, mida tuleb hinnata.</li>
<li><strong><span class="math inline">\(\epsilon\)</span></strong> on vealiige, mis esindab juhuslikku varieeruvust.</li>
</ul>
<p>Mittelineaarse regressiooni parameetreid hinnatakse tavaliselt <strong>vähimruutude meetodil</strong>, kus otsitakse parameetrite väärtusi, mis minimeerivad mudeli ennustatud väärtuste ja tegelike väärtuste vaheliste ruutude summat. See on iteratiivne protsess, mis nõuab arvutitarkvara kasutamist.</p>
<div id="r" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> R<a href="mittelineaarne-regressioon.html#r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Näiteks, kui soovime R-is kasutada <code>nls()</code> mudelit, mis kirjeldab puu kõrgust sõltuvalt puu diameetrist, võime kasutada järgmist näidiskoodi.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="mittelineaarne-regressioon.html#cb57-1" tabindex="-1"></a><span class="co"># Laadime peatükis kasutatavad paketid</span></span>
<span id="cb57-2"><a href="mittelineaarne-regressioon.html#cb57-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb57-3"><a href="mittelineaarne-regressioon.html#cb57-3" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb57-4"><a href="mittelineaarne-regressioon.html#cb57-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb57-5"><a href="mittelineaarne-regressioon.html#cb57-5" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="mittelineaarne-regressioon.html#cb58-1" tabindex="-1"></a><span class="co"># Laadime andmed sisse failist ning</span></span>
<span id="cb58-2"><a href="mittelineaarne-regressioon.html#cb58-2" tabindex="-1"></a><span class="co"># filtreerime välja puud, mille h &gt; 0</span></span>
<span id="cb58-3"><a href="mittelineaarne-regressioon.html#cb58-3" tabindex="-1"></a>andmed <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/naited.xlsx&quot;</span>,<span class="st">&quot;PH_MA&quot;</span>)</span></code></pre></div>
<p><span class="math display">\[H = c0 * (1 - exp(-c1 * A))^{c2}\]</span></p>
<p>Kus A on vanus, H on puistu kõrgus ning c0, c1 ja c2 on mudeli parameetrid.</p>
<p>Mudeli lähendamiseks koostame esmalt oma funktsiooni ning lisame täiendava teisenduse, kus vanus jagatakse 100-ga. Kuna parameeter c1 korrutatakse valemis vanusega ning selle parameetri väärtus on väga väike, siis lähendamine on lihtsam, kui see on sada korda suurem ehk 0,02 asemel on 2.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="mittelineaarne-regressioon.html#cb59-1" tabindex="-1"></a><span class="co"># Määratleme mudeli funktsioon</span></span>
<span id="cb59-2"><a href="mittelineaarne-regressioon.html#cb59-2" tabindex="-1"></a>kasvuMudel <span class="ot">&lt;-</span> <span class="cf">function</span>(A, c0, c1, c2) {</span>
<span id="cb59-3"><a href="mittelineaarne-regressioon.html#cb59-3" tabindex="-1"></a> c0 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>c1 <span class="sc">*</span> A<span class="sc">/</span><span class="dv">100</span>))<span class="sc">^</span>c2</span>
<span id="cb59-4"><a href="mittelineaarne-regressioon.html#cb59-4" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="mittelineaarne-regressioon.html#cb60-1" tabindex="-1"></a><span class="co"># Omista algväärtused parameetritele</span></span>
<span id="cb60-2"><a href="mittelineaarne-regressioon.html#cb60-2" tabindex="-1"></a>alg_param <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">c0 =</span> <span class="dv">20</span>, <span class="at">c1 =</span> <span class="dv">2</span>, <span class="at">c2 =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="mittelineaarne-regressioon.html#cb61-1" tabindex="-1"></a><span class="co"># Sobita mudel andmetele</span></span>
<span id="cb61-2"><a href="mittelineaarne-regressioon.html#cb61-2" tabindex="-1"></a>mudel <span class="ot">&lt;-</span> <span class="fu">nls</span>(H <span class="sc">~</span> <span class="fu">kasvuMudel</span>(A, c0, c1, c2), <span class="at">data =</span> andmed, <span class="at">start =</span> alg_param)</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="mittelineaarne-regressioon.html#cb62-1" tabindex="-1"></a><span class="co"># Vaata mudeli kokkuvõtet</span></span>
<span id="cb62-2"><a href="mittelineaarne-regressioon.html#cb62-2" tabindex="-1"></a><span class="fu">summary</span>(mudel)</span></code></pre></div>
<pre><code>
Formula: H ~ kasvuMudel(A, c0, c1, c2)

Parameters:
   Estimate Std. Error t value Pr(&gt;|t|)    
c0  26,8400     0,2211   121,4  &lt; 2e-16 ***
c1   2,2104     0,0787    28,1  1,4e-11 ***
c2   1,4858     0,0510    29,1  9,2e-12 ***
---
Signif. codes:  0 &#39;***&#39; 0,001 &#39;**&#39; 0,01 &#39;*&#39; 0,05 &#39;.&#39; 0,1 &#39; &#39; 1

Residual standard error: 0,175 on 11 degrees of freedom

Number of iterations to convergence: 4 
Achieved convergence tolerance: 1,52e-06</code></pre>
<p>Esitame selle kohta ka graafiku.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="mittelineaarne-regressioon.html#cb64-1" tabindex="-1"></a><span class="fu">ggplot</span>(andmed, <span class="fu">aes</span>(<span class="at">x =</span> A, <span class="at">y =</span> H)) <span class="sc">+</span></span>
<span id="cb64-2"><a href="mittelineaarne-regressioon.html#cb64-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-3"><a href="mittelineaarne-regressioon.html#cb64-3" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb64-4"><a href="mittelineaarne-regressioon.html#cb64-4" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb64-5"><a href="mittelineaarne-regressioon.html#cb64-5" tabindex="-1"></a>      <span class="fu">predict</span>(mudel, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">A =</span> x)),</span>
<span id="cb64-6"><a href="mittelineaarne-regressioon.html#cb64-6" tabindex="-1"></a>    <span class="at">color =</span> <span class="dv">2</span></span>
<span id="cb64-7"><a href="mittelineaarne-regressioon.html#cb64-7" tabindex="-1"></a>  ) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-53"></span>
<img src="_main_files/figure-html/unnamed-chunk-53-1.png" alt="Mittelineaarne regressioon" width="80%" />
<p class="caption">
Joonis 8.1: Mittelineaarne regressioon
</p>
</div>
<p><strong><code>ggplot(andmed, aes(x = A, y = H)) +</code></strong></p>
<ul>
<li><strong><code>ggplot(andmed, ...)</code>:</strong> See alustab <code>ggplot2</code> graafiku loomist. <code>andmed</code> on andmestik (tõenäoliselt <code>data.frame</code> objekt), mida graafikul kasutatakse.</li>
<li><strong><code>aes(x = A, y = H)</code>:</strong> See määrab graafiku esteetilised omadused (aesthetics).
<ul>
<li><strong><code>x = A</code>:</strong> Määrab, et graafiku x-teljel kuvatakse andmestiku <code>andmed</code> veerg <code>A</code>.</li>
<li><strong><code>y = H</code>:</strong> Määrab, et graafiku y-teljel kuvatakse andmestiku <code>andmed</code> veerg <code>H</code>.</li>
</ul></li>
<li><strong><code>+</code>:</strong> See märk näitab, et graafiku definitsioon jätkub järgmistel ridadel (lisatakse kihte).</li>
</ul>
<p><strong><code>geom_point() +</code></strong></p>
<ul>
<li><strong><code>geom_point()</code>:</strong> See lisab graafikule punkti kihi (scatter plot). Iga punkt vastab ühele vaatluspaarile andmestikus <code>andmed</code>, kus punkti x-koordinaat on <code>A</code> väärtus ja y-koordinaat on <code>H</code> väärtus.</li>
<li><strong><code>+</code>:</strong> Jätkab graafiku definitsiooni.</li>
</ul>
<p><strong><code>stat_function(...)</code></strong></p>
<ul>
<li><strong><code>stat_function(...)</code>:</strong> See lisab graafikule funktsiooni joonistamise kihi. See on kasulik, kui tahame joonistada mingit matemaatilist funktsiooni või, nagu antud juhul, mudeli ennustust.
<ul>
<li><strong><code>fun = function(x) predict(mudel, newdata = data.frame(A = x))</code>:</strong> See määrab joonistatava funktsiooni.
<ul>
<li><strong><code>function(x)</code>:</strong> See defineerib anonüümse funktsiooni, mille sisendiks on <code>x</code>. <code>stat_function</code> annab sellele funktsioonile automaatselt x-telje väärtused mingis vahemikus.</li>
<li><strong><code>predict(mudel, newdata = data.frame(A = x))</code>:</strong> See on funktsiooni tuum. See kutsub välja <code>predict()</code> funktsiooni, et arvutada <code>mudel</code> (eeldame, et see on eelnevalt defineeritud <code>nls</code> mudel) ennustused uutele andmepunktidele.
<ul>
<li><strong><code>mudel</code>:</strong> Eelnevalt defineeritud mudeli objekt.</li>
<li><strong><code>newdata = data.frame(A = x)</code>:</strong> See loob uue <code>data.frame</code> objekti, kus veeru <code>A</code> väärtuseks on funktsiooni sisend <code>x</code>. Sisuliselt arvutab see mudeli ennustused erinevatele <code>A</code> väärtustele, mida <code>stat_function</code> ette annab.</li>
</ul></li>
</ul></li>
<li><strong><code>color = 2</code>:</strong> See määrab joonistatava joone värviks punase (värvikood 2 R-is on punane).</li>
</ul></li>
</ul>
<p>Järgnevalt kontrollime ka jääkide hajuvust.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="mittelineaarne-regressioon.html#cb65-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">fitted =</span> <span class="fu">fitted</span>(mudel), <span class="at">resid =</span> <span class="fu">resid</span>(mudel)),</span>
<span id="cb65-2"><a href="mittelineaarne-regressioon.html#cb65-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> resid)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="mittelineaarne-regressioon.html#cb65-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb65-4"><a href="mittelineaarne-regressioon.html#cb65-4" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb65-5"><a href="mittelineaarne-regressioon.html#cb65-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x))  <span class="co"># Lisab sujuva joone GAM mudeli abil</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-54"></span>
<img src="_main_files/figure-html/unnamed-chunk-54-1.png" alt="Jäägid vs ennustatud" width="80%" />
<p class="caption">
Joonis 8.2: Jäägid vs ennustatud
</p>
</div>
<p><strong><code>ggplot(data.frame(fitted = fitted(mudel), resid = resid(mudel)), ...)</code></strong></p>
<ul>
<li><strong><code>ggplot(...)</code>:</strong> See alustab <code>ggplot2</code> graafiku loomist.</li>
<li><strong><code>data.frame(fitted = fitted(mudel), resid = resid(mudel))</code>:</strong> See loob andmestiku (<code>data.frame</code> objekti), mida graafikul kasutatakse. See on selle koodilõigu tuum.
<ul>
<li><strong><code>fitted = fitted(mudel)</code>:</strong> See arvutab mudeli <code>mudel</code> abil ennustatud väärtused (fitted values) kõikidele andmepunktidele, mis olid algselt kasutusel mudeli treenimisel. Need väärtused salvestatakse tulpa nimega <code>fitted</code>.</li>
<li><strong><code>resid = resid(mudel)</code>:</strong> See arvutab jäägid (residuals) mudeli <code>mudel</code> jaoks. Jääk on tegeliku väärtuse ja ennustatud väärtuse vahe. Need väärtused salvestatakse tulpa nimega <code>resid</code>.</li>
</ul></li>
<li><strong><code>aes(x = fitted, y = resid) +</code>:</strong> See määrab graafiku esteetilised omadused:
<ul>
<li><strong><code>x = fitted</code>:</strong> Määrab, et x-teljel kuvatakse ennustatud väärtused (tulbast <code>fitted</code>).</li>
<li><strong><code>y = resid</code>:</strong> Määrab, et y-teljel kuvatakse jäägid (tulbast <code>resid</code>).</li>
</ul></li>
<li><strong><code>+</code>:</strong> See märk näitab, et graafiku definitsioon jätkub järgmistel ridadel.</li>
</ul>
<p><strong><code>geom_point() +</code></strong></p>
<ul>
<li><strong><code>geom_point()</code>:</strong> See lisab graafikule punkti kihi. Iga punkt vastab ühele vaatluspunktile, kus punkti x-koordinaat on ennustatud väärtus ja y-koordinaat on jääk.</li>
<li><strong><code>+</code>:</strong> Jätkab graafiku definitsiooni.</li>
</ul>
<p><strong><code>geom_hline(yintercept = 0) +</code></strong></p>
<ul>
<li><strong><code>geom_hline(yintercept = 0)</code>:</strong> See lisab graafikule horisontaalse joone, mille y-koordinaat on 0. See joon on abiks jääkide jaotuse hindamisel - ideaalis peaksid jäägid paiknema juhuslikult nulljoone ümber.</li>
<li><strong><code>+</code>:</strong> Jätkab graafiku definitsiooni.</li>
</ul>
<p><strong><code>geom_smooth(method = "gam", formula = y ~ s(x))</code></strong></p>
<ul>
<li><strong><code>geom_smooth(...)</code>:</strong> See lisab graafikule silutud joone kihi.
<ul>
<li><strong><code>method = "gam"</code>:</strong> See määrab silumise meetodiks GAM (Generalized Additive Model). GAM on paindlik meetod mittelineaarsete seoste modelleerimiseks.</li>
<li><strong><code>formula = y ~ s(x)</code>:</strong> See määrab mudeli valemi.
<ul>
<li><strong><code>y ~ ...</code>:</strong> Näitab, et modelleeritakse y-telje väärtust (jääke).</li>
<li><strong><code>s(x)</code>:</strong> Näitab, et x-telje väärtuse (ennustatud väärtuste) ja y-telje väärtuse (jääkide) vahelist seost modelleeritakse sujuva funktsiooniga (splainiga). See võimaldab tuvastada mittelineaarseid mustreid.</li>
</ul></li>
</ul></li>
</ul>
<p><strong>Mida sellelt graafikult otsida:</strong></p>
<ul>
<li><strong>Juhuslik hajuvus:</strong> Ideaalis peaksid punktid paiknema juhuslikult nulljoone ümber, ilma selge mustrita.</li>
<li><strong>Süsteemne muster:</strong> Kui punktid moodustavad mingi süsteemse mustri (nt kaar, lehter), siis see viitab probleemidele mudelis (nt mittelineaarsus, heteroskedastiivsus).</li>
<li><strong>Silutud joone kuju:</strong> Kui silutud joon on sirge ja horisontaalne, siis see viitab, et ennustatud väärtuste ja jääkide vahel puudub süsteemne seos. Kui joon on kõver, siis see viitab mittelineaarsele seosele, mida mudel ei pruugi arvesse võtta.</li>
</ul>
</div>
<div id="ms-excel-1" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> MS Excel<a href="mittelineaarne-regressioon.html#ms-excel-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>MS Exceli keskkonnas saab mittelineaarse funktsiooni parameetrite hindamiseks kasutada optimeerimisprotseduuri Solver. Selleks tuleks MS Exceli töölehele salvestada argumenttunnuse väärtused, funktsioontunnuse väärtused, prognoosifunktsiooni arvutusvalemid ja prognoosijääkide ruutude summa arvutuseeskiri. Samuti peavad töölehel olema lahtrid funktsiooni parameetrite jaoks, mida prognoosifunktsiooni arvutusvalemid kasutavad. MS Exceli optimeerimisalgoritm käivitatakse menüüst: Andmed, Solver.</p>
<p>Andmete ettevalmistamisel tuleb esmalt määrata lahtrid, kuhu kirjutatakse mudeli parameetrid. Järgnevas näites on need lahtrites G1:G3 ning nende nimetused on lahtrites F1:F3. Kõrguse kõrval tulpa on sisestatud valem, millega kõrgust prognoositakse sõltuvalt vanusest. Eraldi on välja arvutatud prognoosijääkide ruutude summa (SSE) MS Exceli funktsiooniga <code>SUMXMY2()</code>, millel on sisendiks tegelik kõrgus ja prognoositud kõrgus.</p>
<p>Solverile tuleb anda ette lahtrid, mille väärtust minimeeritakse (SSE) ja lahtrid, mille väärtusi protseduur hakkab muutma, et minimeerida prognoosijääkide ruutude summat.</p>
<div class="float">
<img src="pildid/ms_excel_solver.png" alt="Solveriga parameetrite lähendamine" />
<div class="figcaption">Solveriga parameetrite lähendamine</div>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mitme-tunnuse-koosanalüüs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mitteparameetriline-analüüs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"caption": {
"figure_num_sep": ".",
"table_num_sep": "."
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
