<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Peatükk 9 Mitteparameetriline analüüs | Metsanduslik statistika R ja MS Excel keskkonnas</title>
  <meta name="description" content="Metsandusliku statistika õpik" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Peatükk 9 Mitteparameetriline analüüs | Metsanduslik statistika R ja MS Excel keskkonnas" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Metsandusliku statistika õpik" />
  <meta name="github-repo" content="xyzallan/met-stat-opik" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Peatükk 9 Mitteparameetriline analüüs | Metsanduslik statistika R ja MS Excel keskkonnas" />
  
  <meta name="twitter:description" content="Metsandusliku statistika õpik" />
  

<meta name="author" content="Allan Sims, Andres Kiviste, Diana Laarmann" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mittelineaarne-regressioon.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="sissejuhatus.html"><a href="sissejuhatus.html"><i class="fa fa-check"></i><b>1</b> Sissejuhatus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sissejuhatus.html"><a href="sissejuhatus.html#statistikaprogramm-r"><i class="fa fa-check"></i><b>1.1</b> Statistikaprogramm R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="sissejuhatus.html"><a href="sissejuhatus.html#r-i-paketid"><i class="fa fa-check"></i><b>1.1.1</b> R-i paketid</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sissejuhatus.html"><a href="sissejuhatus.html#ms-excel"><i class="fa fa-check"></i><b>1.2</b> MS Excel</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="andmestik.html"><a href="andmestik.html"><i class="fa fa-check"></i><b>2</b> Andmestik</a>
<ul>
<li class="chapter" data-level="2.1" data-path="andmestik.html"><a href="andmestik.html#andmestiku-struktuur-r-keskkonnas"><i class="fa fa-check"></i><b>2.1</b> Andmestiku struktuur R keskkonnas</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="andmestik.html"><a href="andmestik.html#vektor"><i class="fa fa-check"></i><b>2.1.1</b> Vektor</a></li>
<li class="chapter" data-level="2.1.2" data-path="andmestik.html"><a href="andmestik.html#maatriks"><i class="fa fa-check"></i><b>2.1.2</b> Maatriks</a></li>
<li class="chapter" data-level="2.1.3" data-path="andmestik.html"><a href="andmestik.html#andmetabel"><i class="fa fa-check"></i><b>2.1.3</b> Andmetabel</a></li>
<li class="chapter" data-level="2.1.4" data-path="andmestik.html"><a href="andmestik.html#list"><i class="fa fa-check"></i><b>2.1.4</b> List</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="andmestik.html"><a href="andmestik.html#andmestike-importimine-r-keskkonda"><i class="fa fa-check"></i><b>2.2</b> Andmestike importimine R keskkonda</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="09-mitteparameetriline.html"><a href="#andmestike-r%C3%BChmitamine"><i class="fa fa-check"></i><b>3</b> Andmestike rühmitamine</a>
<ul>
<li class="chapter" data-level="3.1" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html"><i class="fa fa-check"></i><b>3.1</b> Jaotused</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#empiiriline-jaotus"><i class="fa fa-check"></i><b>3.1.1</b> Empiiriline jaotus</a></li>
<li class="chapter" data-level="3.1.2" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#teoreetiline-jaotus"><i class="fa fa-check"></i><b>3.1.2</b> Teoreetiline jaotus</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#histogramm"><i class="fa fa-check"></i><b>3.2</b> Histogramm</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#r-keskkonnas"><i class="fa fa-check"></i><b>3.2.1</b> R keskkonnas:</a></li>
<li class="chapter" data-level="3.2.2" data-path="andmestike-rühmitamine.html"><a href="andmestike-rühmitamine.html#exceli-keskkonnas"><i class="fa fa-check"></i><b>3.2.2</b> Exceli keskkonnas:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="karakteristikud.html"><a href="karakteristikud.html"><i class="fa fa-check"></i><b>4</b> Karakteristikud</a>
<ul>
<li class="chapter" data-level="4.1" data-path="karakteristikud.html"><a href="karakteristikud.html#keskmised"><i class="fa fa-check"></i><b>4.1</b> Keskmised</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="karakteristikud.html"><a href="karakteristikud.html#aritmeetiline-keskmine"><i class="fa fa-check"></i><b>4.1.1</b> Aritmeetiline keskmine</a></li>
<li class="chapter" data-level="4.1.2" data-path="karakteristikud.html"><a href="karakteristikud.html#ruutkeskmine"><i class="fa fa-check"></i><b>4.1.2</b> Ruutkeskmine</a></li>
<li class="chapter" data-level="4.1.3" data-path="karakteristikud.html"><a href="karakteristikud.html#geomeetriline-keskmine"><i class="fa fa-check"></i><b>4.1.3</b> Geomeetriline keskmine</a></li>
<li class="chapter" data-level="4.1.4" data-path="karakteristikud.html"><a href="karakteristikud.html#harmooniline-keskmine"><i class="fa fa-check"></i><b>4.1.4</b> Harmooniline keskmine</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="karakteristikud.html"><a href="karakteristikud.html#kvantiilid"><i class="fa fa-check"></i><b>4.2</b> Kvantiilid</a></li>
<li class="chapter" data-level="4.3" data-path="karakteristikud.html"><a href="karakteristikud.html#mediaan"><i class="fa fa-check"></i><b>4.3</b> Mediaan</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html"><i class="fa fa-check"></i><b>5</b> Jaotusfunktsioonid</a>
<ul>
<li class="chapter" data-level="5.1" data-path="09-mitteparameetriline.html"><a href="#h%C3%BCpotees"><i class="fa fa-check"></i><b>5.1</b> Hüpotees</a></li>
<li class="chapter" data-level="5.2" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#jaotusfunktsioon"><i class="fa fa-check"></i><b>5.2</b> Jaotusfunktsioon</a></li>
<li class="chapter" data-level="5.3" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#tihedusfunktsioon"><i class="fa fa-check"></i><b>5.3</b> Tihedusfunktsioon</a></li>
<li class="chapter" data-level="5.4" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#normaaljaotus"><i class="fa fa-check"></i><b>5.4</b> Normaaljaotus</a></li>
<li class="chapter" data-level="5.5" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#t-jaotus"><i class="fa fa-check"></i><b>5.5</b> T-jaotus</a></li>
<li class="chapter" data-level="5.6" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#f-jaotus"><i class="fa fa-check"></i><b>5.6</b> F-jaotus</a></li>
<li class="chapter" data-level="5.7" data-path="jaotusfunktsioonid.html"><a href="jaotusfunktsioonid.html#hii-ruut-jaotus"><i class="fa fa-check"></i><b>5.7</b> Hii-ruut-jaotus</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html"><i class="fa fa-check"></i><b>6</b> Statistilised hinnangud</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#hinnangud"><i class="fa fa-check"></i><b>6.1</b> Hinnangud</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#punkthinnang"><i class="fa fa-check"></i><b>6.1.1</b> Punkthinnang</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#vahemikhinnangud"><i class="fa fa-check"></i><b>6.2</b> Vahemikhinnangud</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="09-mitteparameetriline.html"><a href="#keskv%C3%A4%C3%A4rtuse-usalduspiirid"><i class="fa fa-check"></i><b>6.2.1</b> Keskväärtuse usalduspiirid</a></li>
<li class="chapter" data-level="6.2.2" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#dispersiooni-usalduspiirid"><i class="fa fa-check"></i><b>6.2.2</b> Dispersiooni usalduspiirid</a></li>
<li class="chapter" data-level="6.2.3" data-path="statistilised-hinnangud.html"><a href="statistilised-hinnangud.html#binoomjaotuse-usalduspiirid"><i class="fa fa-check"></i><b>6.2.3</b> Binoomjaotuse usalduspiirid</a></li>
<li class="chapter" data-level="6.2.4" data-path="09-mitteparameetriline.html"><a href="#standardh%C3%A4lbe-usalduspiirid"><i class="fa fa-check"></i><b>6.2.4</b> Standardhälbe usalduspiirid</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="09-mitteparameetriline.html"><a href="#mitme-tunnuse-koosanal%C3%BC%C3%BCs"><i class="fa fa-check"></i><b>7</b> Mitme tunnuse koosanalüüs</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mitme-tunnuse-koosanalüüs.html"><a href="mitme-tunnuse-koosanalüüs.html"><i class="fa fa-check"></i><b>7.1</b> Lineaarne regressioon</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="mitme-tunnuse-koosanalüüs.html"><a href="mitme-tunnuse-koosanalüüs.html#lineaarne-regressioon-r-keskkonnas"><i class="fa fa-check"></i><b>7.1.1</b> Lineaarne regressioon R keskkonnas</a></li>
<li class="chapter" data-level="7.1.2" data-path="mitme-tunnuse-koosanalüüs.html"><a href="mitme-tunnuse-koosanalüüs.html#lineaarne-regressioon-ms-exceli-keskkonnas"><i class="fa fa-check"></i><b>7.1.2</b> Lineaarne regressioon MS Exceli keskkonnas</a></li>
<li class="chapter" data-level="7.1.3" data-path="09-mitteparameetriline.html"><a href="#regressioonanal%C3%BC%C3%BCsi-tulemuste-t%C3%B5lgendamine"><i class="fa fa-check"></i><b>7.1.3</b> Regressioonanalüüsi tulemuste tõlgendamine</a></li>
<li class="chapter" data-level="7.1.4" data-path="mitme-tunnuse-koosanalüüs.html"><a href="mitme-tunnuse-koosanalüüs.html#homoskedastilisuse-testimine"><i class="fa fa-check"></i><b>7.1.4</b> Homoskedastilisuse testimine</a></li>
<li class="chapter" data-level="7.1.5" data-path="09-mitteparameetriline.html"><a href="#j%C3%A4%C3%A4kide-normaalsuse-test"><i class="fa fa-check"></i><b>7.1.5</b> Jääkide normaalsuse test</a></li>
<li class="chapter" data-level="7.1.6" data-path="mitme-tunnuse-koosanalüüs.html"><a href="mitme-tunnuse-koosanalüüs.html#multikollineaarsus"><i class="fa fa-check"></i><b>7.1.6</b> Multikollineaarsus</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="09-mitteparameetriline.html"><a href="#dispersioonanal%C3%BC%C3%BCs"><i class="fa fa-check"></i><b>7.2</b> Dispersioonanalüüs</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mittelineaarne-regressioon.html"><a href="mittelineaarne-regressioon.html"><i class="fa fa-check"></i><b>8</b> Mittelineaarne regressioon</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mittelineaarne-regressioon.html"><a href="mittelineaarne-regressioon.html#r"><i class="fa fa-check"></i><b>8.1</b> R</a></li>
<li class="chapter" data-level="8.2" data-path="mittelineaarne-regressioon.html"><a href="mittelineaarne-regressioon.html#ms-excel-1"><i class="fa fa-check"></i><b>8.2</b> MS Excel</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="09-mitteparameetriline.html"><a href="#mitteparameetriline-anal%C3%BC%C3%BCs"><i class="fa fa-check"></i><b>9</b> Mitteparameetriline analüüs</a>
<ul>
<li class="chapter" data-level="9.1" data-path="09-mitteparameetriline.html"><a href="#%C3%BCldistatud-aditiivne-mudel"><i class="fa fa-check"></i><b>9.1</b> Üldistatud aditiivne mudel</a></li>
<li class="chapter" data-level="9.2" data-path="mitteparameetriline-analüüs.html"><a href="mitteparameetriline-analüüs.html"><i class="fa fa-check"></i><b>9.2</b> Visualiseerimine paketiga <code>ggplot2</code></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Metsanduslik statistika R ja MS Excel keskkonnas</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mitteparameetriline-analüüs" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Peatükk 9</span> Mitteparameetriline analüüs<a href="#mitteparameetriline-anal%C3%BC%C3%BCs" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="üldistatud-aditiivne-mudel" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Üldistatud aditiivne mudel<a href="#%C3%BCldistatud-aditiivne-mudel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Üldistatud aditiivne mudel (GAM) on statistiline mudel, mis ühendab lineaarse mudeli omadused aditiivsete funktsioonide abil. Lihtsamalt öeldes on GAM mudel, mis modelleerib funktsioontunnust ühe või mitme argumenttunnuse summa abil, kus iga argumenttunnuse mõju funktsioontunnusele modelleeritakse splainfunktsiooni abil.</p>
<p>Splainfunktsioon on matemaatiline funktsioon, mida kasutatakse andmete interpoleerimiseks ja sujuvaks lähendamiseks. See on ühesuguse struktuuriga tükiti polünomiaalne funktsioon, mis on konstrueeritud nii, et see oleks sujuv ja pidev andmepunktide vahel. See tähendab, et spline funktsioonil ei ole järske hüppeid ega nurki, mis teeb selle ideaalseks tööriistaks sujuvate kõverate ja pindade modelleerimiseks.</p>
<p>Selles näites kasutame R-i paketti <code>mgcv</code> GAM mudeli sobitamiseks. Eesmärk on modelleerida puu kõrguse ja diameetri vahelist seost, eeldades, et see seos ei pruugi olla lineaarne.</p>
<p>Kõigepealt laadime andmestiku, mis sisaldab puude kõrguse ja diameetri mõõtmiste andmeid.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="mitteparameetriline-analüüs.html#cb115-1" tabindex="-1"></a><span class="co"># Laadime peatükis kasutatavad paketid</span></span>
<span id="cb115-2"><a href="mitteparameetriline-analüüs.html#cb115-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb115-3"><a href="mitteparameetriline-analüüs.html#cb115-3" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb115-4"><a href="mitteparameetriline-analüüs.html#cb115-4" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="mitteparameetriline-analüüs.html#cb116-1" tabindex="-1"></a><span class="co"># Andmete laadimine</span></span>
<span id="cb116-2"><a href="mitteparameetriline-analüüs.html#cb116-2" tabindex="-1"></a>andmed <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/naited.xlsx&quot;</span>,<span class="st">&quot;prt_andmed&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(h <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code></pre></div>
<p>GAM mudeli lähendamiseks kasutame funktsiooni <code>gam()</code> paketist <code>mgcv</code>. Kasutame splainfunktsiooni diameetri muutuja jaoks, et modelleerida mittelineaarset seost.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="mitteparameetriline-analüüs.html#cb117-1" tabindex="-1"></a><span class="co"># GAM mudeli sobitamine</span></span>
<span id="cb117-2"><a href="mitteparameetriline-analüüs.html#cb117-2" tabindex="-1"></a>mudel <span class="ot">&lt;-</span> <span class="fu">gam</span>(h <span class="sc">~</span> <span class="fu">s</span>(d), <span class="at">data =</span> andmed)</span></code></pre></div>
<p>Selles koodis:</p>
<ul>
<li><code>H ~ s(D)</code> määrab mudeli valemi. <code>H</code> on funktsioontunnus ja <code>s(D)</code> määrab, et diameetri (D) mõju kõrgusele modelleeritakse sujuva funktsiooni <code>s()</code> abil.</li>
<li><code>data = andmed</code> määrab andmestiku, mida kasutada.</li>
</ul>
<p><strong>3. Mudeli kokkuvõtte vaatamine:</strong></p>
<p>Saame mudeli kohta detailse kokkuvõtte funktsiooni <code>summary()</code> abil:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="mitteparameetriline-analüüs.html#cb118-1" tabindex="-1"></a><span class="co"># Mudeli kokkuvõte</span></span>
<span id="cb118-2"><a href="mitteparameetriline-analüüs.html#cb118-2" tabindex="-1"></a><span class="fu">summary</span>(mudel)</span></code></pre></div>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
h ~ s(d)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   24,368      0,182     134   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0,001 &#39;**&#39; 0,01 &#39;*&#39; 0,05 &#39;.&#39; 0,1 &#39; &#39; 1

Approximate significance of smooth terms:
      edf Ref.df  F p-value    
s(d) 3,68   4,61 24  &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0,001 &#39;**&#39; 0,01 &#39;*&#39; 0,05 &#39;.&#39; 0,1 &#39; &#39; 1

R-sq.(adj) =  0,705   Deviance explained = 72,8%
GCV = 1,7242  Scale est. = 1,5525    n = 47</code></pre>
<p>Kokkuvõte annab meile informatsiooni mudeli sobivuse kohta, sh:</p>
<ul>
<li><strong>Parametric coefficients:</strong> Kui mudelis on ka lineaarseid komponente, näidatakse siin nende koefitsiendid. Kuna mudelis ühtegi lineaarset tunnust ei ole kasutatud, siis on siin ainult vabaliige <code>(Intercept)</code>.</li>
<li><strong>Approximate significance of smooth terms:</strong> Siin näeme p-väärtuse hinnangut splainfunktsiooni olulisuse kohta. Madal p-väärtus (&lt;0.05) viitab statistiliselt olulisele mittelineaarsele seosele diameetri ja kõrguse vahel.</li>
<li><strong>R-sq.(adj):</strong> Korrigeeritud determinatsioonikordaja näitab, kui suure osa kõrguse varieeruvusest mudel seletab.</li>
<li><strong>Deviance explained:</strong> Sarnane determinatsioonikordajale, näitab mudeli poolt seletatud hälbimuse osakaalu.</li>
</ul>
<p>Kasutades funktsiooni <code>coef()</code>, näeme splainfunktsiooni polünoomi parameetrite väärtusi.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="mitteparameetriline-analüüs.html#cb120-1" tabindex="-1"></a><span class="fu">coef</span>(mudel)</span></code></pre></div>
<pre><code>(Intercept)      s(d).1      s(d).2      s(d).3      s(d).4      s(d).5 
   24,36809    -1,65141    -0,89974    -0,00196     0,03456    -0,04304 
     s(d).6      s(d).7      s(d).8      s(d).9 
    0,18773    -0,13235    -0,81294     3,44774 </code></pre>
<p>Saame visualiseerida diameetri ja kõrguse vahelist seost funktsiooni <code>plot()</code> abil:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="mitteparameetriline-analüüs.html#cb122-1" tabindex="-1"></a><span class="co"># Mudeli visualiseerimine</span></span>
<span id="cb122-2"><a href="mitteparameetriline-analüüs.html#cb122-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.7</span>, <span class="dv">0</span>))</span>
<span id="cb122-3"><a href="mitteparameetriline-analüüs.html#cb122-3" tabindex="-1"></a><span class="fu">plot</span>(mudel)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-88"></span>
<img src="_main_files/figure-html/unnamed-chunk-88-1.png" alt="Kõrguse sõltuvus diameetrist" width="80%" />
<p class="caption">
Joonis 9.1: Kõrguse sõltuvus diameetrist
</p>
</div>
<p>See kuvab graafiku, mis näitab diameetri mõju puu kõrgusele. Pidevjoon näitab modelleeritud seost ja kriipsjooned näitavad usaldusvahemikku. See graafik aitab visuaalselt hinnata seose kuju ja mittelineaarsust.</p>
<p>Saame kasutada mudelit uute puude kõrguse ennustamiseks, andes ette diameetri väärtused funktsiooni <code>predict()</code> abil:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="mitteparameetriline-analüüs.html#cb123-1" tabindex="-1"></a><span class="co"># Uute diameetrite väärtused</span></span>
<span id="cb123-2"><a href="mitteparameetriline-analüüs.html#cb123-2" tabindex="-1"></a>uued_diameetrid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">32</span>))</span>
<span id="cb123-3"><a href="mitteparameetriline-analüüs.html#cb123-3" tabindex="-1"></a></span>
<span id="cb123-4"><a href="mitteparameetriline-analüüs.html#cb123-4" tabindex="-1"></a><span class="co"># Ennustuste tegemine</span></span>
<span id="cb123-5"><a href="mitteparameetriline-analüüs.html#cb123-5" tabindex="-1"></a>ennustused <span class="ot">&lt;-</span> <span class="fu">predict</span>(mudel, <span class="at">newdata =</span> uued_diameetrid)</span>
<span id="cb123-6"><a href="mitteparameetriline-analüüs.html#cb123-6" tabindex="-1"></a></span>
<span id="cb123-7"><a href="mitteparameetriline-analüüs.html#cb123-7" tabindex="-1"></a><span class="co"># Ennustuste kuvamine</span></span>
<span id="cb123-8"><a href="mitteparameetriline-analüüs.html#cb123-8" tabindex="-1"></a><span class="fu">print</span>(ennustused)</span></code></pre></div>
<pre><code>   1    2    3 
18,1 24,1 26,3 </code></pre>
</div>
<div id="visualiseerimine-paketiga-ggplot2" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Visualiseerimine paketiga <code>ggplot2</code><a href="mitteparameetriline-analüüs.html#visualiseerimine-paketiga-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Oletame, et meil on samad andmed puude kõrguse (h) ja diameetri (d) kohta nagu eelmistes näidetes, aga me tahame luua hajuvusdiagrammi ja lisada sellele sujuva joone otse <code>ggplot2</code> abil, ilma et peaks eraldi <code>gam()</code> funktsiooni kasutama.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="mitteparameetriline-analüüs.html#cb125-1" tabindex="-1"></a><span class="co"># Laadi pakett</span></span>
<span id="cb125-2"><a href="mitteparameetriline-analüüs.html#cb125-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Kasutame <code>ggplot()</code> funktsiooni koos <code>geom_point()</code> ja <code>geom_smooth()</code> funktsioonidega:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="mitteparameetriline-analüüs.html#cb126-1" tabindex="-1"></a><span class="fu">ggplot</span>(andmed, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> h)) <span class="sc">+</span></span>
<span id="cb126-2"><a href="mitteparameetriline-analüüs.html#cb126-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>  <span class="co"># Joonistab hajuvusdiagrammi</span></span>
<span id="cb126-3"><a href="mitteparameetriline-analüüs.html#cb126-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x)) <span class="sc">+</span>  <span class="co"># Lisab sujuva joone GAM mudeli abil</span></span>
<span id="cb126-4"><a href="mitteparameetriline-analüüs.html#cb126-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Diameeter (cm)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Kõrgus (m)&quot;</span>) <span class="sc">+</span></span>
<span id="cb126-5"><a href="mitteparameetriline-analüüs.html#cb126-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-91"></span>
<img src="_main_files/figure-html/unnamed-chunk-91-1.png" alt="Kõrguse sõltuvus diameetrist" width="80%" />
<p class="caption">
Joonis 9.2: Kõrguse sõltuvus diameetrist
</p>
</div>
<p>Selgitus:</p>
<ul>
<li><code>ggplot(puud, aes(x = d, y = h))</code>: See rida loob <code>ggplot</code> objekti ja määrab andmestiku (<code>andmed</code>) ning x-telje (diameeter - <code>D</code>) ja y-telje (kõrgus - <code>H</code>) muutujad.</li>
<li><code>geom_point()</code>: See funktsioon lisab graafikule punktid, luues hajuvusdiagrammi. Iga punkt esindab ühte puud.</li>
<li><code>geom_smooth(method = "gam", formula = y ~ s(x))</code>: See funktsioon lisab graafikule sujuva joone.
<ul>
<li><code>method = "gam"</code>: Määrab, et sujuva joone sobitamiseks kasutatakse GAM mudelit.</li>
<li><code>formula = y ~ s(x)</code>: Määrab mudeli valemi. <code>y ~ s(x)</code> tähendab, et <code>y</code> (meie puhul kõrgus <code>H</code>) modelleeritakse <code>x</code> (meie puhul diameeter <code>D</code>) sujuva funktsiooni <code>s()</code> abil. See on sama valem, mida kasutasime eelmistes näidetes <code>gam()</code> funktsiooni sees.</li>
</ul></li>
<li><code>labs(...)</code>: Määrab telgede sildid ja graafiku pealkirja.</li>
<li><code>theme_bw()</code>: Muudab graafiku teema must-valgeks.</li>
</ul>
<p>Sarnaselt eelmisele näitele saate <code>ggplot2</code> abil graafikut vastavalt oma soovile kohandada. Näiteks:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="mitteparameetriline-analüüs.html#cb127-1" tabindex="-1"></a><span class="fu">ggplot</span>(andmed, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> h, <span class="at">color =</span> pl)) <span class="sc">+</span></span>
<span id="cb127-2"><a href="mitteparameetriline-analüüs.html#cb127-2" tabindex="-1"></a>  <span class="co"># Muudab punktide värvi, kuju ja suurust</span></span>
<span id="cb127-3"><a href="mitteparameetriline-analüüs.html#cb127-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>  </span>
<span id="cb127-4"><a href="mitteparameetriline-analüüs.html#cb127-4" tabindex="-1"></a>  <span class="co"># Eemaldab usaldusvahemiku ja muudab joone värvi</span></span>
<span id="cb127-5"><a href="mitteparameetriline-analüüs.html#cb127-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">s</span>(x)) <span class="sc">+</span>  </span>
<span id="cb127-6"><a href="mitteparameetriline-analüüs.html#cb127-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Diameeter (D)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Kõrgus (H)&quot;</span>) <span class="sc">+</span></span>
<span id="cb127-7"><a href="mitteparameetriline-analüüs.html#cb127-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-92"></span>
<img src="_main_files/figure-html/unnamed-chunk-92-1.png" alt="Kõrguse sõltuvus diameetrist" width="80%" />
<p class="caption">
Joonis 9.3: Kõrguse sõltuvus diameetrist
</p>
</div>
<p>Selles näites:</p>
<ul>
<li><code>aes(x = D, y = H, color = PL)</code> on lisatud, et värv sõltub puuliigist.</li>
</ul>
<p>See näide demonstreerib, kuidas luua hajuvusdiagramm ja lisada sellele sujuv joon, mis on sobitatud GAM mudeli abil, kasutades ainult <code>ggplot2</code> funktsioone. See on mugav viis kiiresti visualiseerida mittelineaarseid seoseid andmetes ilma eraldi GAM mudelit sobitamata. <code>ggplot2</code> pakub laialdasi võimalusi graafikute kohandamiseks, võimaldades luua informatiivseid ja visuaalselt meeldivaid visualiseeringuid.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mittelineaarne-regressioon.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"caption": {
"figure_num_sep": ".",
"table_num_sep": "."
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
